function monstaLatestVersionCallback(e){window.MONSTA_LATEST_VERSION=e;var t=document.createEvent("CustomEvent");t.initEvent("latestVersionLoadEVent",!0,!0),document.dispatchEvent(t)}function TransferStats(e){this.completedItems=-1,this.previousCompletedItems=-1,this.totalItems=e,this.previousSampleTime=-1,this._transferRateSamples=[],this.transferType=""}function ModalUpgradeRequiredController(e,t,n){function o(){""===c.upgradeRequiredMessage&&n(["UPGRADE_TRIAL_LINK_TEXT","UPGRADE_PURCHASE_LINK_TEXT"]).then(r,function(e){}),t(s).modal("show")}function i(){t(s).modal("hide")}function r(e){var t="TRIAL_A_TAG_START"+e.UPGRADE_TRIAL_LINK_TEXT+"A_TAG_END",o="PURCHASE_A_TAG_START"+e.UPGRADE_PURCHASE_LINK_TEXT+"A_TAG_END";n("UPGRADE_REQUIRED_MESSAGE",{trial_link:t,purchase_link:o}).then(a,function(e){})}function a(e){e=e.replace(/TRIAL_A_TAG_START/g,'<a href="'+MFTP_UPGRADE_TRIAL_URL+'" target="mftp-new" rel="noopener noreferrer">'),e=e.replace(/PURCHASE_A_TAG_START/g,'<a href="'+MFTP_UPGRADE_PURCHASE_URL+'" target="mftp-new" rel="noopener noreferrer">'),c.upgradeRequiredMessage=e.replace(/A_TAG_END/g,"</a>")}var s="#modal-upgrade-required",c=this;c.show=o,c.hide=i,c.upgradeRequiredMessage="",e.$on("upgrade-required-modal:display",o)}function getMFP(){try{return[navigator.userAgent,[screen.height,screen.width,screen.colorDepth].join("x"),(new Date).getTimezoneOffset(),!!window.sessionStorage,!!window.localStorage,$.map(navigator.plugins,function(e){return[e.name,e.description,$.map(e,function(e){return[e.type,e.suffixes].join("~")}).join(",")].join("::")}).join(";")].join("###").hashCode()}catch(e){return null}}function getMUuid(){try{var e=localStorage.getItem("mftp-uuid");return null==e&&(e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),localStorage.setItem("mftp-uuid",e)),e.replace(/-/g,"")}catch(e){return getMFP()}}function getFpQs(){var e=getMUuid();return null==e?"":"&amp;fp="+e}function rot13(e){return e.replace(/[a-zA-Z]/g,function(e){return String.fromCharCode((e<="Z"?90:122)>=(e=e.charCodeAt(0)+13)?e:e-26)})}function allInterfaceOptionsDisabled(e,t){if(null===t)return!1;if(Object.keys(t).length!==e.length)return!1;for(var n in t)if(t.hasOwnProperty(n)){if(!1!==t[n])return!1;if(-1===e.indexOf(n))return!1}return!0}function basicURLValidate(e){return new RegExp("^\\s*https?://.+","i").test(e)}function extractFileExtension(e){if("string"!=typeof e)return"";var t=e.split(".");return 1==t.length||2==t.length&&""==t[0]?"":t[t.length-1].toLowerCase()}function isArchiveFilename(e){switch(extractFileExtension(e)){case"zip":case"tar":case"gz":return!0;default:return!1}}function isExtractSupported(e){return isArchiveFilename(e)}function isEmpty(e){return null===e||void 0===e||""===e}function ensureTrailingSlash(e){return"/"!=e.substr(e.length-1,1)?e+"/":e}function isSubPath(e,t){return!(t.length<e.length)&&(e=ensureTrailingSlash(e),t=ensureTrailingSlash(t),t.substr(0,e.length)==e)}function nameJoin(e){switch(e.length){case 0:return"";case 1:return e[0];default:for(var t="",n=0;n<e.length-1;++n)t+=e[n],n<e.length-2&&(t+=", ");return t+=" and "+e[e.length-1]}}function normalizeFileSize(e){if("number"!=typeof e)return"";for(var t="B",n=e,o=[[1099511627776,"TB"],[1073741824,"GB"],[1048576,"MB"],[1024,"KB"]],i=0;i<o.length;++i)if(e>=o[i][0]){n=e/o[i][0],n=n.toFixed(1),t=o[i][1];break}return"KB"==t&&(n=Math.round(n)),n+t}function objectValueIsSetAndFalse(e,t){return e.hasOwnProperty(t)&&!1===e[t]}function objectMultipleValuesAreSetAndFalse(e,t){for(var n=0;n<t.length;++n)if(!objectValueIsSetAndFalse(e,t[n]))return!1;return!0}function setAllObjectValuesFalseForKeys(e,t){for(var n=0;n<t.length;++n)e[t[n]]=!1}function normalizeFooterDisplayOptions(e){var t=["upload-file","upload-folder","upload-archive"];objectValueIsSetAndFalse(e,"upload")?setAllObjectValuesFalseForKeys(e,t):objectMultipleValuesAreSetAndFalse(e,t)&&(e.upload=!1);var n=["new-folder","new-file"];objectValueIsSetAndFalse(e,"new-item")?setAllObjectValuesFalseForKeys(e,n):objectMultipleValuesAreSetAndFalse(e,n)&&(e["new-item"]=!1);var o=["remote-server","username","upload-limit","version"];return objectValueIsSetAndFalse(e,"session-information")?setAllObjectValuesFalseForKeys(e,o):objectMultipleValuesAreSetAndFalse(e,o)&&(e["session-information"]=!1),e}function objectKeyIsFalse(e,t){return!!e.hasOwnProperty(t)&&!1===e[t]}function parentPath(e){if(e.length<=1)return"/";for(var t="/"==e.substr(0,1);e.length&&"/"==e.substr(e.length-1,1);)e=e.substr(0,e.length-1);for(var n=[],o=e.split("/"),i=0;i<o.length-1;++i){var r=o[i];0!=r.length&&n.push(r)}return 0==n.length?"/":(t?"/":"")+n.join("/")}function safeConsoleError(e){window.console&&window.console.error&&console.error(e)}function parseErrorResponse(e,t){if(safeConsoleError(e),e.data&&e.data.errors)return e.data.errors.join(" ");var n=isEmpty(t)?"":" during "+t;return 408==e.status||-1==e.status?"OPERATION_TIMEOUT":"An unknown error occurred"+n+"."}function getLocalizedErrorFromResponse(e){return void 0===e.data||null===e.data?null:getLocalizedErrorFromResponseData(e.data)}function getLocalizedErrorFromResponseData(e){return e&&e.localizedErrors&&0!=e.localizedErrors.length?e.localizedErrors[0]:null}function getErrorMessageFromResponseData(e){return e&&e.errors&&0!=e.errors.length?e.errors[0]:null}function pathJoin(e,t){return e+("/"==e.substr(e.length-1,1)||""==e?"":"/")+t}function responseIsUnsuccessful(e){return void 0==e.data||1!=e.data.success}function showResponseErrorWithTranslatedAction(e,t,n,o){function i(e){a.push(e),a.length==r&&n.$broadcast("modal-error:show",a.join(" "))}if(e.data&&e.data.localizedErrors)for(var r=e.data.localizedErrors.length,a=[],s=0;s<r;++s){var c=e.data.localizedErrors[s];void 0===c.context||c.context,safeConsoleError(e.data),null==c.context&&(c.context={}),void 0==c.context.operation&&(c.context.operation=t),o(c.context.operation).then(function(e){c.context.operation=e,o(c.errorName,c.context).then(i,i)},function(){o(c.errorName,c.context).then(i,i)})}else n.$broadcast("modal-error:show",parseErrorResponse(e,t),null,{action:t})}function showResponseError(e,t,n,o){o(t).then(function(t){showResponseErrorWithTranslatedAction(e,t,n,o)},function(){showResponseErrorWithTranslatedAction(e,t,n,o)})}function splitFileExtension(e){var t=!1;"."==e.substr(0,1)&&(e=e.substr(1,e.length-1),t=!0);var n,o=e.split("."),i="";return o.length>1?(i="."+o[o.length-1],n=o.slice(0,o.length-1).join(".")):n=o[0],[(t?".":"")+n,i]}function b64EncodeUnicode(e){return btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,function(e,t){return String.fromCharCode(parseInt("0x"+t))}))}function b64DecodeUnicode(e){return decodeURIComponent(Array.prototype.map.call(atob(e),function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))}function validateFileNameNonEmpty(e){return""!=e}function validateFileNameContainsNoSlash(e){return-1==e.indexOf("/")}function mapParseInt(e){return parseInt(e)}function simpleCompare(e,t){return e-t}function betaVersionComponentCompare(e,t){var n=-1!=e.indexOf("b"),o=-1!=t.indexOf("b"),i=e.split("b").map(mapParseInt),r=t.split("b").map(mapParseInt);if(n&&o){var a=simpleCompare(i[0],r[0]);return 0!=a?a:simpleCompare(i[1],r[1])}return n?i[0]>r[0]?1:-1:r[0]>i[0]?1:-1}function versionComponentCompare(e,t){return-1!=e.indexOf("b")||-1!=t.indexOf("b")?betaVersionComponentCompare(e,t):simpleCompare(parseInt(e),parseInt(t))}function versionIsLessThan(e,t){for(var n=e.split(".");n.length<4;)n.push("0");for(var o=t.split(".");o.length<4;)o.push("0");for(var i=0;i<n.length;++i){var r=versionComponentCompare(n[i],o[i]);if(0!=r)return r<0}return!1}function mCheckFn(e){if(document.removeEventListener("lload",mCheckFn),1!=e.lType){window.setTimeout(function(){},Math.random()%8e3+1e4);for(var t=("string".substr(0,3),(!0+"").substr(0,1)),n=(!1+"").substr(2,1),o=(!1+"").substr(4,1),i=(!1+"").substr(2,1),r=document.getElementsByTagName(t+"i"+t+n+o)[0],a="fT"+String.fromCharCode(80),s="Monsta "+a.toUpperCase(),c=r.text,l=c!==s,u=window,d=(u.alert,document.getElementsByClassName("toolbar")),f=2!==d.length,h=0;h<d.length;++h){var p=d[h],m=window.getComputedStyle(p),g=m.backgroundColor;if(-1===g.indexOf("53, 53, 53")&&-1===g.indexOf("353535")){!0;break}}for(var y=i+"ogo",v=document.getElementsByClassName(y),E=!1,S=0;S<v.length;++S)if(v[S].tagName==="SP"+(!1+"").substr(1,1).toUpperCase()+"N"){var A=v[S].currentStyle||u.getComputedStyle(v[S],null),T=A.backgroundImage.slice(4,-1);E=-1==T.indexOf("monsta-"+i+"ogo"+-400+"w.png")}var R=String,C="g_",w="len"+C.substr(0,1)+"th",_=l||f||E;if(window[C+"loadComplete"]=!_,_){for(var I=[164,202,196,228,194,220,200,210,220,206,64,222,204],F="",P=0;P<I[w];++P)F+=R.fromCharCode(I[P]/2);F+=" "+s+" ";for(var b=[52.5,57.5,16,55.5,55,54,60.5,16,56,50.5,57,54.5,52.5,58,58,50.5,50,16,59.5,52.5,58,52,16,58,52,50.5,16,34.5,55,58,50.5,57,56,57,52.5,57.5,50.5,16,34.5,50,52.5,58,52.5,55.5,55,23,16,33.5,54,52.5,49.5,53.5,16,39.5,37.5,23.5,33.5,54,55.5,57.5,50.5,16,51,55.5,57,16,54.5,55.5,57,50.5,16,50,50.5,58,48.5,52.5,54,57.5,23],D=0;D<b[w];++D)F+=R.fromCharCode(2*b[D]);for(var L=[[l,"title"],[f,"toolbarCount"],[E,"logoUrlChanged"]],O="",x=0;x<L.length;++x)L[x][0]&&(O+=L[x][1]+",");var M="c="+encodeURIComponent(O)+"&loc="+encodeURIComponent(window.location),U="https://monstaftp.com/failure-record.php?"+M,N=document.createElement("script");N.setAttribute("src",U),document.head.appendChild(N)}for(var q=document.getElementsByTagName("style"),$=0;$<q.length;++$){var B=q[$];if(void 0!=B.text&&void 0!=B.text.indexOf&&-1==B.text.indexOf("ng-cloak")){B.parentNode.removeChild(B)}}for(var k=document.getElementsByTagName("link"),G=0;G<k.length;++G){var H=k[G];if("stylesheet"==H.getAttribute("rel")){var j=H.getAttribute("href");void 0!=j&&0!=j.indexOf("//ajax.googleapis.com")&&0!=j.indexOf("//maxcdn.bootstrapcdn.com")&&0!=j.indexOf("//fonts.googleapis.com")&&0!=j.indexOf("//cdnjs.cloudflare.com")&&"application/frontend/css/monsta.css"!=j&&H.parentNode.removeChild(H)}}}}var TRANSFER_RATE_UPDATE_INTERVAL=200,TRANSFER_ITEMS_MIN_UPDATE=8192,TRANSFER_RATE_SAMPLES_MAX=10,TRANSFER_COMPLETE_MODAL_HIDE_DELAY=700,AUTOSAVE_DELAY_MS=3e3,MAX_CONCURRENT_UPLOADS=1,MAX_UPLOAD_BYTES=-1,UPLOAD_ACTION="uploadFileToNewDirectory",UPLOAD_ARCHIVE_ACTION="uploadArchive",API_PATH="application/api/api.php",DOWNLOAD_PATH="application/api/download.php",UPLOAD_PATH="application/api/upload.php",MULTI_STAGE_UPLOAD_PATH="application/api/upload-multistage.php",CM_MODE_BASE="//cdnjs.cloudflare.com/ajax/libs/codemirror/5.17.0/mode/",DEBUG=!1,FEATURE_MULTI_STAGE_UPLOAD=!1,RELEASE_NOTES_URL="https://www.monstaftp.com/notes",MFTP_DOWNLOAD_URL="https://www.monstaftp.com/download",MFTP_UPGRADE_TRIAL_URL="https://www.monstaftp.com/freetrial",MFTP_UPGRADE_PURCHASE_URL="https://www.monstaftp.com/upgrade",g_ConnectionDefaults={ftp:{port:21},sftp:{port:22}};angular.module("MonstaFTP",["pascalprecht.translate"]),angular.module("MonstaFTP").config(["$httpProvider",function(e){"use strict";var t=0;e.interceptors.push(["$rootScope","$q",function(e,n){var o=function(n){t+=n,e.$broadcast("request-count-change",t)};return{request:function(e){return e.__ignoreStatusIndicator||o(1),e},responseError:function(e){return safeConsoleError(e),e.config.__ignoreStatusIndicator||o(-1),n.reject(e)},response:function(e){return e.config.__ignoreStatusIndicator||o(-1),e}}}])}]),angular.module("MonstaFTP").config(["$translateProvider",function(e){"use strict";if(e.useSanitizeValueStrategy("escape"),window.underTest||e.useStaticFilesLoader({prefix:"application/languages/",suffix:".json"}),e.useMessageFormatInterpolation(),e.fallbackLanguage("en_us"),window.localStorage)try{var t=localStorage.getItem("monsta-setting-language");t&&(g_defaultLanguage=JSON.parse(t))}catch(e){}e.preferredLanguage(g_defaultLanguage)}]),angular.module("MonstaFTP").config(["$locationProvider",function(e){e.hashPrefix("")}]),function(){function e(){return{isAuthenticated:!1,rememberLogin:!1,configuration:null,connectionType:null,initialDirectory:null,hasServerSavedAuthentication:!1,_localStorageSupported:null,getConfigurationAsJSON:function(){return JSON.stringify(this.configuration)},setConfigurationFromJSON:function(e){this.configuration=null==e?null:JSON.parse(e)},localStorageSupported:function(){if(null==this._localStorageSupported){var e=window.localStorage;try{e.setItem("test","1"),e.removeItem("test"),this._localStorageSupported=!0}catch(e){this._localStorageSupported=!1}}return this._localStorageSupported},postLogin:function(){this.isAuthenticated=!0,this.saveSettings()},loadSettings:function(){this.localStorageSupported()&&(this.loadMetaConfiguration(),this.rememberLogin&&this.loadConfiguration())},saveSettings:function(){this.localStorageSupported()&&(this.saveMetaConfiguration(),this.rememberLogin?this.saveConfiguration():this.clearConfiguration())},clearSettings:function(){this.localStorageSupported()&&(this.rememberLogin||this.clearConfiguration())},logout:function(){this.isAuthenticated=!1,this.initialDirectory=null,this.saveSettings(),this.clearSettings(),this.configuration=null},loadConfiguration:function(){this.localStorageSupported()&&(this.setConfigurationFromJSON(localStorage.getItem("monsta-configuration")),this.connectionType=localStorage.getItem("monsta-connectionType"),this.initialDirectory=localStorage.getItem("monsta-initialDirectory"))},saveConfiguration:function(){this.localStorageSupported()&&(localStorage.setItem("monsta-configuration",this.getConfigurationAsJSON()),localStorage.setItem("monsta-connectionType",this.connectionType),localStorage.setItem("monsta-initialDirectory",this.initialDirectory))},clearConfiguration:function(){localStorage.removeItem("monsta-configuration"),localStorage.removeItem("monsta-connectionType"),localStorage.removeItem("monsta-initialDirectory")},loadMetaConfiguration:function(){this.localStorageSupported()&&(this.rememberLogin="true"===localStorage.getItem("monsta-rememberLogin"),this.isAuthenticated="true"===localStorage.getItem("monsta-isAuthenticated"),this.hasServerSavedAuthentication="true"===localStorage.getItem("monsta-hasServerSavedAuthentication"))},saveMetaConfiguration:function(){this.localStorageSupported()&&(localStorage.setItem("monsta-isAuthenticated",1==this.isAuthenticated?"true":"false"),localStorage.setItem("monsta-rememberLogin",1==this.rememberLogin?"true":"false"),localStorage.setItem("monsta-hasServerSavedAuthentication",1==this.hasServerSavedAuthentication?"true":"false"))},hasStoredAuthenticationDetails:function(){return!isEmpty(this.connectionType)&&!isEmpty(this.configuration)},getActiveConfiguration:function(){if(null===this.configuration)return null;var e=this.configuration[this.connectionType];return void 0!==e.port&&null!=e.port&&(e.port=parseInt(e.port)),e},clearAuthConfiguration:function(){this.localStorageSupported()&&localStorage.removeItem("monsta-configuration")}}}angular.module("MonstaFTP").factory("authenticationFactory",e)}(),function(){function e(e,t,n){function o(e){return e.preventDefault(),l.changeDirectoryToItem(n(this).data("index")),!1}function i(e,t){var i=n('<li class="breadcrumb-display"></li>'),r=n('<a href="#" data-index="'+t+'"></a>').text(e+" ");return r.click(o),i.append(r),i}function r(){var e=n("#breadcrumb-ol"),t=n("#breadcrumb__home_link"),o=n("#history > button"),r=n(window).width(),a=r-o.width()-120,s=0;e.find(".breadcrumb-display").remove();for(var c=l.pathComponents.length-1,u=null,d=c;d>=0;--d){var f=l.pathComponents[d],h=i(f,d+1);if(null===u&&(u=h),t.after(h),(s+=h.outerWidth())>a){if(d!=c&&h.remove(),0!=c){var p=i("…",d+1);t.after(p)}break}}if(s>a)for(var m=1;u.offset().left+u.outerWidth()+15>r;){++m;var g=l.pathComponents[c],y=g.length,v=g.substr(0,y-m);if(v+="…",u.text(v),y-m==1)break}}function a(e){if("string"!=typeof e||0==e.length)return l.pathComponents=[],void(l.hasLeadingSlash=!1);l.hasLeadingSlash="/"==e.substr(0,1),"/"==e?l.pathComponents=[]:(l.pathComponents=e.split("/"),""==l.pathComponents[0]&&l.pathComponents.splice(0,1),""==l.pathComponents[l.pathComponents.length-1]&&l.pathComponents.splice(l.pathComponents.length-1,1)),l.renderBreadcrumbs()}function s(e){var n="";0!=e&&(n=l.pathComponents.slice(0,e).join("/"));var o=(l.hasLeadingSlash?"/":"")+n;t.$broadcast("change-directory",o)}function c(e,t){l.setPath(t)}var l=this;l.pathComponents=[],l.hasLeadingSlash=!1,l.renderBreadcrumbs=r,this.setPath=a,this.changeDirectoryToItem=s,e.$on("directory-changed",c),e.$on("logout",function(){l.setPath("/")}),n(window).resize(function(){l.renderBreadcrumbs()})}angular.module("MonstaFTP").controller("BreadcrumbController",e),e.$inject=["$scope","$rootScope","jQuery"]}(),function(){function e(e,t,n){var o=window.g_xhrTimeoutSeconds||30,i=["downloadMultipleFiles","fetchFile","fetchRemoteFile","copy","extractArchive","deleteMultiple","transferUploadToRemote"],r=function(e,t,n){e.actionName=t,e.context={remotePath:n}},a=function(e,t,n,o){e.actionName=t,e.context={source:n,destination:o}};return{_sendRequest:function(t,r,a){var s,c=-1==i.indexOf(t.actionName)?1e3*o:null;if(a){var l=n.defer(),u=function(e){l.resolve(e)};s=l.promise}else s=c;var d={method:"POST",url:API_PATH,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(JSON.stringify(e[n])));return t.join("&")},timeout:s,data:{request:t},__ignoreStatusIndicator:!!r};DEBUG&&console.log(d);var f=e(d);return a?{promise:f,cancel:u}:f},getRequestBody:function(){var e=angular.copy(t.getActiveConfiguration());if(null!==e){var n=g_ConnectionDefaults[t.connectionType];if(n)for(var o in n)n.hasOwnProperty(o)&&(null!=e[o]&&void 0!=e[o]&&""!=e[o]||(e[o]=n[o]))}return{connectionType:t.connectionType,configuration:e}},getEmptyRequestBody:function(){return{connectionType:null,configuration:null}},getListDirectoryRequest:function(e,t,n){e.actionName="listDirectory",e.context={path:t,showHidden:n}},getFetchFileRequest:function(e,t){r(e,"fetchFile",t)},getMakeDirectoryRequest:function(e,t){r(e,"makeDirectory",t)},getDeleteDirectoryRequest:function(e,t){r(e,"deleteDirectory",t)},getDeleteFileRequest:function(e,t){r(e,"deleteFile",t)},getCopyRequest:function(e,t,n){a(e,"copy",t,n)},getRenameRequest:function(e,t,n){a(e,"rename",t,n)},getChangePermissionsRequest:function(e,t,n){r(e,"changePermissions",t),e.context.mode=n},getPutFileContentsRequest:function(e,t,n,o,i,r){e.actionName="putFileContents",e.context={remotePath:t,fileContents:n,originalFileContents:o,confirmOverwrite:!0===r},i&&(e.context.encoding="rot13")},getGetFileContentsRequest:function(e,t){e.actionName="getFileContents",e.context={remotePath:t}},getTestConnectAndAuthenticateRequest:function(e,t){e.actionName="testConnectAndAuthenticate",e.context={getServerCapabilities:t}},getCheckSavedAuthExistsRequest:function(e){e.actionName="checkSavedAuthExists",e.context={}},getWriteSavedAuthRequest:function(e,t,n){e.actionName="writeSavedAuth",e.context={password:t,authData:n}},getReadSavedAuthRequest:function(e,t){e.actionName="readSavedAuth",e.context={password:t}},getReadLicenseRequest:function(e){e.actionName="readLicense",e.context={}},getGetSystemVarsRequest:function(e){e.actionName="getSystemVars",e.context={}},getFetchRemoteFileRequest:function(e,t,n){a(e,"fetchRemoteFile",t,n)},getDownloadMultipleFilesRequest:function(e,t,n){e.actionName="downloadMultipleFiles",e.context={baseDirectory:t,items:n}},getSetApplicationSettingsRequest:function(e,t){e.actionName="setApplicationSettings",e.context={applicationSettings:t}},getDeleteMultipleRequest:function(e,t){e.actionName="deleteMultiple",e.context={pathsAndTypes:t}},getExtractArchiveRequest:function(e,t,n,o){e.actionName="extractArchive",e.context={fileKey:t,fileIndexOffset:n,extractCount:o}},getUpdateLicenseRequest:function(e,t){e.actionName="updateLicense",e.context={license:t}},getReserveUploadContextRequest:function(e,t,n){e.actionName="reserveUploadContext",e.context={actionName:t,remotePath:n}},getTransferUploadToRemoteRequest:function(e,t){e.actionName="transferUploadToRemote",e.context={sessionKey:t}},getGetRemoteFileSizeRequest:function(e,t){e.actionName="getRemoteFileSize",e.context={remotePath:t}},getGetDefaultPathRequest:function(e){e.actionName="getDefaultPath"},getDownloadForExtractRequest:function(e,t){e.actionName="downloadForExtract",e.context={remotePath:t}},getCleanUpExtractRequest:function(e,t){e.actionName="cleanUpExtract",e.context={fileKey:t}},getForgotPasswordRequest:function(e,t){e.actionName="forgotPassword",e.context={username:t}},getResetPasswordRequest:function(e,t,n,o){e.actionName="resetPassword",e.context={username:t,currentPassword:n,newPassword:o}},getValidateSavedAuthPasswordRequest:function(e,t){e.actionName="validateSavedAuthPassword",e.context={password:t}},getDownloadLatestVersionArchiveRequest:function(e,t){e.actionName="downloadLatestVersionArchive",e.context={password:t}},getInstallLatestVersionRequest:function(e,t){e.actionName="installLatestVersion",e.context={password:t}},listDirectory:function(e,t){return this.requestBody=this.getRequestBody(),this.getListDirectoryRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},fetchFile:function(e){return this.requestBody=this.getRequestBody(),this.getFetchFileRequest(this.requestBody,e,!0),this._sendRequest(this.requestBody)},rename:function(e,t){return this.requestBody=this.getRequestBody(),this.getRenameRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},changePermissions:function(e,t){return this.requestBody=this.getRequestBody(),this.getChangePermissionsRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},copy:function(e,t){return this.requestBody=this.getRequestBody(),this.getCopyRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},deleteFile:function(e){return this.requestBody=this.getRequestBody(),this.getDeleteFileRequest(this.requestBody,e),this._sendRequest(this.requestBody)},deleteDirectory:function(e){return this.requestBody=this.getRequestBody(),this.getDeleteDirectoryRequest(this.requestBody,e),this._sendRequest(this.requestBody)},makeDirectory:function(e){return this.requestBody=this.getRequestBody(),this.getMakeDirectoryRequest(this.requestBody,e),this._sendRequest(this.requestBody)},getFileContents:function(e){return this.requestBody=this.getRequestBody(),this.getGetFileContentsRequest(this.requestBody,e),this._sendRequest(this.requestBody)},putFileContents:function(e,t,n,o,i,r){this.requestBody=this.getRequestBody();var a=b64EncodeUnicode(t),s=i?rot13(a):a,c=null;if(null!=n){var l=b64EncodeUnicode(n);c=i?rot13(l):l}return this.getPutFileContentsRequest(this.requestBody,e,s,c,i,r),this._sendRequest(this.requestBody,o)},testConnectAndAuthenticate:function(e){return this.requestBody=this.getRequestBody(),this.getTestConnectAndAuthenticateRequest(this.requestBody,e),this._sendRequest(this.requestBody)},checkSavedAuthExists:function(){return this.requestBody=this.getEmptyRequestBody(),this.getCheckSavedAuthExistsRequest(this.requestBody),this._sendRequest(this.requestBody)},writeSavedAuth:function(e,t){return this.requestBody=this.getEmptyRequestBody(),this.getWriteSavedAuthRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},readSavedAuth:function(e){return this.requestBody=this.getEmptyRequestBody(),this.getReadSavedAuthRequest(this.requestBody,e),this._sendRequest(this.requestBody)},getLicense:function(){return this.requestBody=this.getEmptyRequestBody(),this.getReadLicenseRequest(this.requestBody),this._sendRequest(this.requestBody)},getSystemVars:function(){return this.requestBody=this.getEmptyRequestBody(),this.getGetSystemVarsRequest(this.requestBody),this._sendRequest(this.requestBody)},fetchRemoteFile:function(e,t){return this.requestBody=this.getRequestBody(),this.getFetchRemoteFileRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},downloadMultipleFiles:function(e,t){return this.requestBody=this.getRequestBody(),this.getDownloadMultipleFilesRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},setApplicationSettings:function(e){return this.requestBody=this.getRequestBody(),this.getSetApplicationSettingsRequest(this.requestBody,e),this._sendRequest(this.requestBody)},deleteMultiple:function(e){return this.requestBody=this.getRequestBody(),this.getDeleteMultipleRequest(this.requestBody,e),this._sendRequest(this.requestBody)},extractArchive:function(e,t,n){return this.requestBody=this.getRequestBody(),this.getExtractArchiveRequest(this.requestBody,e,t,n),this._sendRequest(this.requestBody,!0,!0)},updateLicense:function(e){return this.requestBody=this.getRequestBody(),this.getUpdateLicenseRequest(this.requestBody,e),this._sendRequest(this.requestBody)},reserveUploadContext:function(e,t){return this.requestBody=this.getRequestBody(),this.getReserveUploadContextRequest(this.requestBody,e,t),this._sendRequest(this.requestBody)},transferUploadToRemote:function(e){return this.requestBody=this.getRequestBody(),this.getTransferUploadToRemoteRequest(this.requestBody,e),this._sendRequest(this.requestBody)},getRemoteFileSize:function(e){return this.requestBody=this.getRequestBody(),this.getGetRemoteFileSizeRequest(this.requestBody,e),this._sendRequest(this.requestBody)},getDefaultPath:function(){return this.requestBody=this.getRequestBody(),this.getGetDefaultPathRequest(this.requestBody),this._sendRequest(this.requestBody)},downloadForExtract:function(e){return this.requestBody=this.getRequestBody(),this.getDownloadForExtractRequest(this.requestBody,e),this._sendRequest(this.requestBody)},cleanUpExtract:function(e){return this.requestBody=this.getRequestBody(),this.getCleanUpExtractRequest(this.requestBody,e),this._sendRequest(this.requestBody)},forgotPassword:function(e){return this.requestBody=this.getRequestBody(),this.getForgotPasswordRequest(this.requestBody,e),this._sendRequest(this.requestBody)},resetPassword:function(e,t,n){return this.requestBody=this.getRequestBody(),this.getResetPasswordRequest(this.requestBody,e,t,n),this._sendRequest(this.requestBody)},validateSavedAuthPassword:function(e){return this.requestBody=this.getRequestBody(),this.getValidateSavedAuthPasswordRequest(this.requestBody,e),this._sendRequest(this.requestBody)},downloadLatestVersionArchive:function(e){return this.requestBody=this.getRequestBody(),this.getDownloadLatestVersionArchiveRequest(this.requestBody,e),this._sendRequest(this.requestBody,!0)},installLatestVersion:function(e){return this.requestBody=this.getRequestBody(),this.getInstallLatestVersionRequest(this.requestBody,e),this._sendRequest(this.requestBody,!0)}}}angular.module("MonstaFTP").factory("connectionFactory",e),e.$inject=["$http","authenticationFactory","$q"]}(),function(){function e(e,t,n){function o(){return(null===p||m)&&(p=e.getSystemVars().then(i,r)),p}function i(e){return g=e.data.data}function r(e){return m=!0,t.reject(e)}function a(){return e.setApplicationSettings(g.applicationSettings)}function s(e,t){if(null!=g){void 0==g.applicationSettings&&(g.applicationSettings={});var o=g.applicationSettings[e]!=t;g.applicationSettings[e]=t,o&&n.$broadcast("configuration:key-changed",e,t)}}function c(e){return!!g_isMonstaPostEntry&&(-1!=y.indexOf(e)&&(void 0!=g_monstaPostEntryVars.settings&&void 0!=g_monstaPostEntryVars.settings[e]))}function l(e){return g_monstaPostEntryVars.settings[e]}function u(e){return c(e)?l(e):null==g?null:g.applicationSettings[e]}function d(e,t){v[e]!==t&&(v[e]=t,n.$broadcast("server-capability:key-changed",e,t))}function f(e){return v[e]}var h={getSystemConfiguration:o,saveApplicationSettings:a,setApplicationSetting:s,getApplicationSetting:u,setServerCapability:d,getServerCapability:f},p=null,m=!1,g=null,y=["postLogoutUrl","loginFailureRedirect"],v={};return h}angular.module("MonstaFTP").factory("configurationFactory",e),e.$inject=["connectionFactory","$q","$rootScope"]}(),function(){function e(e,t){function n(){if(null==f){var e=window.localStorage;try{e.setItem("test","1"),e.removeItem("test"),f=!0}catch(e){f=!1}}return f}function o(e){var t=localStorage.getItem(e);return"string"==typeof t?JSON.parse(t):t}function i(e,t){localStorage.setItem(e,JSON.stringify(t))}function r(e,t){e="monsta-setting-"+e,n()?i(e,t):h[e]=t}function a(e){return e="monsta-setting-"+e,n()?o(e):h[e]}function s(e){return void 0==a(e)?p[e]:a(e)}function c(){return e.getSystemConfiguration().then(function(e){p=e.applicationSettings},u)}function l(e,n){var o=a(e)!=n;r(e,n),o&&t.$broadcast("configuration:key-changed",e,n)}function u(e){return $q.reject(e)}var d={getApplicationSettings:c,getConfigurationItem:s,setConfigurationItem:l},f=null,h={},p={};return d}angular.module("MonstaFTP").factory("localConfigurationFactory",e),e.$inject=["configurationFactory","$rootScope"]}(),function(){function e(){var e=function(e,t){return e.isDirectory==t.isDirectory?0:e.isDirectory?-1:1},t=function(t,n){var o=e(t,n);return 0!=o?o:t.name.toLowerCase()==n.name.toLowerCase()?0:t.name.toLowerCase()>n.name.toLowerCase()?1:-1},n=function(n,o){var i=e(n,o);return 0!=i?i:n.modificationDate!=o.modificationDate?n.modificationDate-o.modificationDate:t(n,o)},o=function(n,o){var i=e(n,o);return 0!=i?i:n.size!=o.size?n.size-o.size:t(n,o)},i=function(n,o){var i=e(n,o);if(0!=i)return i;var r=extractFileExtension(n.name),a=extractFileExtension(o.name);return r!=a?r>a?1:-1:t(n,o)};return{_handleReverse:function(e,t){return t&&e.reverse(),e},sortByName:function(e,n){return this._handleReverse(e.sort(t),n)},sortByModificationDate:function(e,t){return this._handleReverse(e.sort(n),t)},sortBySize:function(e,t){return this._handleReverse(e.sort(o),t)},sortByType:function(e,t){return this._handleReverse(e.sort(i),t)}}}angular.module("MonstaFTP").factory("directorySortingFactory",e)}(),function(){function e(e,t,n,o,i,r){"use strict";function a(e){if(e.dataTransfer.types){for(var t=0;t<e.dataTransfer.types.length;t++)if("Files"==e.dataTransfer.types[t])return!0;return!1}}function s(e,t,n){for(var o=0;o<e.length;++o){if(n(e[o])){if(!t)return!0}else if(t)return!1}return t}function c(e,t){return s(e,!1,function(e){return!0===e.webkitGetAsEntry()[t]})}function l(e){return c(e,"isDirectory")}function u(e){return c(e,"isFile")}function d(e){return s(e,!0,function(e){return isArchiveFilename(e.webkitGetAsEntry().name)})}function f(e){return s(e,!0,function(e){return isArchiveFilename(e.name)})}function h(t){t.preventDefault();var n=!1,o=t.dataTransfer.items,i=!1===g||!1===E,a=null;if(void 0!=o){if(!1===v&&l(o))return void r.$broadcast("modal-error:show","FOLDER_UPLOAD_DISABLED");if(!1===y&&u(o)&&(n=!0,!1!==E&&d(o)&&(n=!1,a=!0),n))return void r.$broadcast("modal-error:show","FILE_UPLOAD_DISABLED");e.handleItemsBasedUpload(o,!i&&a)}else{var s=t.dataTransfer.files;if(!1===y&&(n=!0,!1!==E&&f(s)&&(n=!1,a=!0)),n)return void r.$broadcast("modal-error:show","FILE_UPLOAD_DISABLED");e.handleFilesBasedUpload(s,!i&&a)}}var p=this,m=t("html"),g=o.isLicensed(),y=!0,v=!0,E=!0;p.handleDropEvent=h,n.$on("license-loaded",function(){g=o.isLicensed(),i.getSystemConfiguration().then(function(){if(o.isLicensed()){g=!0;var e=normalizeFooterDisplayOptions(i.getApplicationSetting("footerItemDisplay")||{});y=!1!==e["upload-file"],v=!1!==e["upload-folder"],E=!1!==e["upload-archive"]}else g=!1},function(e){})}),m.ready(function(){var e=t("#file-xfer-drop");m.on("dragenter",function(){(y||v||E)&&(e.css({top:0,height:$(window).height(),display:"table"}),e.show())}),m.on("dragend",function(){(y||v||E)&&e.hide()}),e.ready(function(){e.on({dragenter:function(e){(y||v||E)&&(e.stopPropagation(),e.preventDefault())},dragleave:function(t){(y||v||E)&&(t.stopPropagation(),t.preventDefault(),e.hide())},dragover:function(e){(y||v||E)&&(e.stopPropagation(),e.preventDefault())},drop:function(t){if(y||v||E){t.stopPropagation(),t.preventDefault();var n=t.originalEvent;if(!n.dataTransfer||!n.dataTransfer.files)return!1;if(!a(n))return!1;p.handleDropEvent(n),e.hide()}},dragend:function(t){(y||v||E)&&(t.stopPropagation(),t.preventDefault(),e.hide())}})})})}angular.module("MonstaFTP").controller("DragDropController",e),e.$inject=["uploadUIFactory","jQuery","$scope","licenseFactory","configurationFactory","$rootScope"]}(),function(){function e(e,t,n,o,i,r,a,s){"use strict";function c(e){if(void 0===e.data||null===e.data)return!1;if(void 0===e.data.localizedErrors)return!1;for(var t=0;t<e.data.localizedErrors.length;++t)if("FILE_CHANGED_ON_SERVER"===e.data.localizedErrors[t].errorName)return!0;return!1}function l(){t.$broadcast("modal-choice:show","FILE_CHANGED_CONFIRM_TITLE","FILE_CHANGE_CONFIRM_MESSAGE",function(){k.contentPutFinish(e.activeFile.path,!1)},[["FILE_CHANGED_OVERWRITE",function(){e.saveActiveFile(!1,!0)}],["FILE_CHANGED_LOAD",function(){k.loadFileContents(e.activeFile.path,function(){g(e.activeFile.name,e.activeFile.path),k.contentPutFinish(e.activeFile.path,!0)})}]])}function u(){e.editorFiles=[],e.activeFile=null}function d(){t.$broadcast("file-editor:will-show"),k.hideProUpgradeMessages=s.getApplicationSetting("hideProUpgradeMessages"),k.savedDirectories=[],o(B).on("shown.bs.modal",f),o(B).modal("show"),o(B).on("hide.bs.modal",h),window.addEventListener("resize",q)}function f(){q()}function h(){o(B).off("hide.bs.modal"),o(B).off("shown.bs.modal"),j&&x(),-1!=k.savedDirectories.indexOf(a.currentDirectory)&&t.$broadcast("change-directory"),null!=H&&H.removeClass("open"),t.$broadcast("file-editor:hide",e.editorFiles.length),o(B).modal("hide"),window.removeEventListener("resize",q)}function p(e){if(null===e)return null;for(var t=monaco.languages.getLanguages(),n=t.length,o=0;o<n;++o){var i=t[o];if(-1!==i.extensions.indexOf(e))return i.id}return null}function m(t,n){var o=k.getEditorFileByPath(n);if(null!=o){if(!0===o.isWidgetSetup)return void(o.dirty||o.widget.setValue(o.contents));P(k.getFileIndexByPath(n));var i,r="editor_ta_"+n;if(t.indexOf(".")>0){var a=t.split(".");i="."+a[a.length-1]}else i=null;window.setTimeout(function(){var t;require.config({paths:{vs:"application/frontend/vs"}});var a=document.getElementById(r);require(["vs/editor/editor.main"],function(){var r=s.getApplicationSetting("editorOptions");r.language=p(i),r.readOnly=!k.allowEdit,t=monaco.editor.create(document.getElementById("editor_display_"+n),r),t.setValue(a.value),o.isWidgetSetup=!0,o.widget=t,t.onDidChangeModelContent(function(){e.textChange(o.path)})})},100)}}function g(t,n){e.activeFile=k.getEditorFileByPath(n),k.setupAdvancedEditor(t,n)}function y(e,t){i.isLicensed()&&k.ensureFileInScope(e,t,!0,function(){g(e,t)})}function v(t,n,o,r){if(k.filePathIsInScope(n)){return k.getEditorFileByPath(n).dirty||!o?(r&&r(),!0):(k.loadFileContents(n,r),!1)}var a={name:t,path:n,contents:null,originalContents:null,dirty:!1,saving:!1,isWidgetSetup:!1,widget:null,cm:null};return i.isLicensed()?e.editorFiles.push(a):e.editorFiles=[a],k.loadFileContents(n,r),!1}function E(t){for(var n=0;n<e.editorFiles.length;++n)if(e.editorFiles[n].path==t)return n;return-1}function S(e){return-1!==k.getFileIndexByPath(e)}function A(t){var n=k.getFileIndexByPath(t);return-1===n?null:e.editorFiles[n]}function T(e,t){var n=k.getEditorFileByPath(e);null!=n&&(n.contents=t,n.originalContents=t,null!=n.widget&&window.setTimeout(function(){n.widget.setValue(t)},100))}function R(e,o){null!=k.getEditorFileByPath(e)&&n.getFileContents(e).then(function(t){k.updateFileContents(e,b64DecodeUnicode(t.data.data)),o&&o()},function(e){showResponseError(e,"FILE_LOAD_OPERATION",t,r)})}function C(t){var n=k.getFileIndexByPath(t);if(-1!==n){var o=e.editorFiles.splice(n,1);if(o.length&&o[0].widget&&(o[0].widget=null),0===e.editorFiles.length)return e.activeFile=null,void k.hide();var i=Math.min(n,e.editorFiles.length-1);e.activeFile=e.editorFiles[i]}}function w(e){t.$broadcast("modal-confirm:show",e,k.confirmTabClose,k.cancelTabClose)}function _(t,n){e.pathOfTabToRemove=n,r("EDITOR_CLOSE_CONFIRM_MESSAGE",{file_name:t}).then(w,w)}function I(){k.removeFile(e.pathOfTabToRemove),e.pathOfTabToRemove=null}function F(){e.pathOfTabToRemove=null}function P(t){e.editorFiles.length<=1||e.editorFiles.splice(0,0,e.editorFiles.splice(t,1)[0])}function b(t,n){var o=k.getFileIndexByPath(t);if(-1!==o){var i=e.editorFiles[o];if(null!==i){if(i.saving=!1,n){i.dirty=!1,i.originalContents=i.contents;var r=t.replace(/\\/g,"/").replace(/\/[^\/]*\/?$/,"");""===r&&(r="/"),-1===k.savedDirectories.indexOf(r)&&k.savedDirectories.push(r),P(o)}window.setTimeout(function(){e.$apply()},100)}}}function D(){G&&window.clearTimeout(G),e.settings.autoSave&&k.allowEdit&&(G=window.setTimeout(function(){G=null,e.saveActiveFile(!0,!1)},AUTOSAVE_DELAY_MS))}function L(e){null!=H&&H.hasClass("open")&&!e.target.classList.contains("close")&&(H.removeClass("open"),x())}function O(){window.addEventListener("click",L),j=!0}function x(){window.removeEventListener("click",L),j=!1}function M(e){return null==H&&(H=o(e.target).parent(),"I"==e.target.tagName&&(H=H.parent())),$=!H.hasClass("open"),e.preventDefault(),H.toggleClass("open"),window.setTimeout(function(){$?O():x()},0),!1}function U(){return!0!==k.hideProUpgradeMessages&&!i.isLicensed()}function N(t){for(var n=[],o=0;o<t.length;++o){var i=t[o];if(0!=i.length)for(var r="/"==i.substr(i.length-1)?i:i+"/",a=0;a<e.editorFiles.length;++a){var s=e.editorFiles[a];if(i==s.path)n.push(s.path);else{if(s.path.length<=r.length)continue;s.path.substr(0,r.length)==r&&n.push(s.path)}}}for(var c=0;c<n.length;++c)k.removeFile(n[c],!0)}function q(){e.activeFile&&e.activeFile.isWidgetSetup&&e.activeFile.widget&&e.activeFile.widget.layout()}e.editorFiles=[],e.activeFile=null,e.pathOfTabToRemove=null,e.licenseFactory=i,e.settings={autoSave:!1};var $,B="#modal-editor",k=this,G=null,H=null,j=!1;k.savedDirectories=[],k.hideProUpgradeMessages=!1,k.allowEdit=!0,k.show=d,k.hide=h,k.setupAdvancedEditor=m,k.startEditingFile=y,k.ensureFileInScope=v,k.getFileIndexByPath=E,k.filePathIsInScope=S,k.getEditorFileByPath=A,k.updateFileContents=T,k.loadFileContents=R,k.removeFile=C,k.initiateConfirmTabClose=_,k.confirmTabClose=I,k.cancelTabClose=F,k.contentPutFinish=b,k.beginAutoSave=D,k.fileListClick=M,k.shouldShowProUpgrade=U,k.itemsMoved=N,e.activateTab=function(t,n){if("BUTTON"!=n.target.tagName){e.activeFile=k.getEditorFileByPath(t);P(k.getFileIndexByPath(t)),null!=H&&H.removeClass("open"),j&&x(),window.setTimeout(function(){e.activeFile.isWidgetSetup&&e.activeFile.widget&&e.activeFile.widget.layout()},100)}},e.closeTabForFile=function(e,t){return k.getEditorFileByPath(t).dirty?(k.initiateConfirmTabClose(e,t),!1):(k.removeFile(t),!1)},e.textChange=function(t){var n=k.getEditorFileByPath(t);if(null!=n){var o=n.dirty;n.dirty=n.contents!==n.widget.getValue(),n.dirty!==o&&window.setTimeout(function(){e.$apply()}),k.beginAutoSave.call(k)}},e.saveActiveFile=function(o,i){if(null!=e.activeFile&&e.activeFile.dirty){e.activeFile.saving=!0,e.activeFile.contents=e.activeFile.widget.getValue();var a=e.activeFile.path,u=s.getApplicationSetting("encodeEditorSaves");n.putFileContents(a,e.activeFile.contents,e.activeFile.originalContents,o,u,i).then(function(){k.contentPutFinish(a,!0)},function(e){c(e)?l():(k.contentPutFinish(a,!1),showResponseError(e,"FILE_SAVE_OPERATION",t,r))})}},e.$on("file-editor:edit",function(e,t,n){i.isLicensed()&&(k.allowEdit=!s.getApplicationSetting("disableFileEdit")),k.startEditingFile(t,n),k.show()}),e.$on("file-editor:show",function(){k.show()}),e.$on("logout",function(){u()}),e.$on("login",function(){u()}),e.$on("items-deleted",function(e,t){k.itemsMoved(t)}),e.$on("items-moved",function(e,t){for(var n=[],o=0;o<t.length;++o)n.push(t[o][0]);k.itemsMoved(n)})}angular.module("MonstaFTP").controller("FileEditorController",e),e.$inject=["$scope","$rootScope","connectionFactory","jQuery","licenseFactory","$translate","uiOperationFactory","configurationFactory"]}(),function(){function e(e,t,n,o,i,r,a,s,c,l,u,d,f,h,p,m,g){"use strict";function y(){null!=Pe.systemVars&&1==Oe&&Pe.changeDirectory(null==r.initialDirectory?"/":r.initialDirectory,!0)}function v(e){return{position:"fixed",left:e.clientX+be+"px",top:e.clientY+De+"px","margin-left":0,"margin-top":0}}function E(e,t){A(e.clientX+be,t)&&t.css("margin-left",-(t.width()+Le)),T(e.clientY+De,t)&&t.css("margin-top",-(t.height()+Le)),t.css("opacity",1)}function S(){s(".context-catcher-tr").contextmenu(function(e){var t=s(this),n=t.find(".dropdown-menu").first(),o=t.data("index");return Ue=-1!=d.getSelectedItems().indexOf(o),n.css(v(e)),s(this).find(".context-catcher-button").dropdown("toggle"),n.css("opacity",0),setTimeout(function(){E(e,n)},$e?100:1),$e=!1,-1==["DIV","TR","TD"].indexOf(e.target.tagName)&&d.selectItem(o),!1});var t=s(".file-toolbar");s(".context-catcher-button").click(function(){var t=$(this).parent().parent().parent(),n=t.data("index");d.selectItem(n),e.$apply()}),t.on("shown.bs.dropdown",function(){var e=s(this).find(".dropdown-menu");Me=e;var t=e.parent().removeClass("dropup");"fixed"!=e.css("position")&&e.offset().top+e.outerHeight()>s(window).height()-s("#footer").height()&&t.addClass("dropup")}),t.on("hidden.bs.dropdown",function(){s(this).find(".dropdown-menu").attr("style",null),Me=null})}function A(e,t){return e+t.outerWidth()>s(window).width()}function T(e,t){return e+t.outerHeight()>s(window).height()-s("#footer").height()}function R(){e.directoryList=Pe.sortDirectoryList(e.directoryList,Pe.sortName,Pe.sortReversed)}function C(e){Pe.sortReversed=e==Pe.sortName&&!Pe.sortReversed,Pe.sortName=e,Pe.doReorder()}function w(e,t,n){var o=null;switch(t){case"name":o="sortByName";break;case"modified":o="sortByModificationDate";break;case"size":o="sortBySize";break;case"type":o="sortByType"}return null==o?e:l[o](e,n)}function _(n,i,s){e.directoryList=Pe.sortDirectoryList(i.data.data,Pe.sortName,Pe.sortReversed),o.currentDirectoryList=e.directoryList,o.currentDirectory=n,d.clearSelection(),s&&(e.isHistoryChangeDir||a.addEntry(o.currentDirectory),e.isHistoryChangeDir=!1,t.$broadcast("directory-changed",n),r.initialDirectory=n,r.saveSettings()),c(function(){Pe.setupContextMenuEvents()})}function I(e,i,r){h.getApplicationSettings().then(function(){var a;a=r?function(){}:function(e){i?n.getDefaultPath().then(function(e){Pe.changeDirectory(e.data.data)},function(){showResponseError(e,"DIRECTORY_CHANGE_OPERATION",t,u)}):showResponseError(e,"DIRECTORY_CHANGE_OPERATION",t,u)},n.listDirectory(e,h.getConfigurationItem("showDotFiles")).then(function(t){Pe.directoryListSuccess(e,t,e!=o.currentDirectory)},a)},function(e){showResponseError(e,"APPLICATION_SETTINGS_LOAD_OPERATION",t,u)})}function F(){Pe.changeDirectory(o.currentDirectory)}function P(e){if(responseIsUnsuccessful(e))return void showResponseError(e,"DOWNLOAD_OPERATION",t,u);var n=e.data.fileKey;s("#download-iframe").attr("src",DOWNLOAD_PATH+"?fileKey="+n)}function b(e){showResponseError(e,"DOWNLOAD_OPERATION",t,u),t.$broadcast("modal-prompt:clear-busy")}function D(e){n.fetchFile(e).then(P,b)}function L(){var t=d.getSelectedItems(),i=[];t.map(function(t){i.push(e.directoryList[t].name)}),n.downloadMultipleFiles(o.currentDirectory,i).then(P,b)}function O(){var t=o.joinNameToCurrentDirectory(e.directoryList[d.getSelectedItems()[0]].name);Pe.downloadFileAtPath(t)}function x(){var t=d.getSelectedItems();t.length>1||e.directoryList[t[0]].isDirectory?Pe.downloadMultiple():Pe.downloadSingle()}function M(){var t=d.getSelectedItems().slice();return t.sort(function(e,t){return e-t}),t.map(function(t){return o.joinNameToCurrentDirectory(e.directoryList[t].name)})}function U(e){0!=e.length&&o.setCopySource(e)}function N(e){0!=e.length&&o.setCutSource(e)}function q(){Pe.initiateCutOfPaths(Pe.getSelectedPaths())}function B(){Pe.initiateCopyOfPaths(Pe.getSelectedPaths())}function k(){u("EXISTING_FILE_SUFFIX").then(function(e){G(e)},function(){G("Copy")})}function G(e){if(null!=o.cutSource||null!=o.copySource){var i,r;null!=o.cutSource?(i=o.cutSource,r="rename"):(i=o.copySource,r="copy");for(var a=0;a<i.length;++a){var s=i[a];if(isSubPath(s,o.currentDirectory))return void t.$broadcast("modal-error:show","PASTE_TO_SUB_DIRECTORY_ERROR");var c=s.split("/"),l=Re(c[c.length-1],e),d=o.joinNameToCurrentDirectory(l);n[r](s,d).then(function(){o.pasteComplete(),Pe.changeDirectory(o.currentDirectory),"rename"==r&&t.$broadcast("items-moved",[[s,d]])},function(e){showResponseError(e,"FILE_PASTE_OPERATION",t,u)})}}}function H(){var n=[].concat(e.directoriesToDelete||[],e.filesToDelete||[]);t.$broadcast("items-deleted",n),e.directoriesToDelete=null,e.filesToDelete=null,Pe.changeDirectory(o.currentDirectory)}function j(){var i=[];null!=e.filesToDelete&&e.filesToDelete.map(function(e){o.isCutOrCopySource(e)&&o.clearCutAndCopySource(),i.push([e,!1])}),null!=e.directoriesToDelete&&e.directoriesToDelete.map(function(e){o.isCutOrCopySource(e)&&o.clearCutAndCopySource(),i.push([e,!0])}),n.deleteMultiple(i).then(function(){Pe.deleteComplete()},function(e){showResponseError(e,"DELETE_ITEM_OPERATION",t,u),Pe.deleteComplete()})}function V(){e.filesToDelete=null,e.directoriesToDelete=null}function z(e){t.$broadcast("modal-confirm:show",e,Pe.confirmDelete,Pe.cancelDelete)}function W(e){u("DELETE_CONFIRM_MESSAGE",{item_count:e.length}).then(function(e){z(e)},function(e){z(e)})}function Q(){var t=d.getSelectedItems();if(0!==t.length){var n=[];e.directoriesToDelete=[],e.filesToDelete=[];for(var i=0;i<t.length;++i){var r=t[i],a=e.directoryList[r];n.push(a.name);var s=o.joinNameToCurrentDirectory(a.name);a.isDirectory?e.directoriesToDelete.push(s):e.filesToDelete.push(s)}f.getApplicationSetting("disableDeleteConfirmation")?Pe.confirmDelete():Pe.showDeleteConfirm(n)}}function K(){Pe.newItemPath=null,e.makeItemType=null}function X(){if(t.$broadcast("modal-prompt:hide"),Pe.refreshDirectoryList(),e.makeItemType==Be)return void K();h.getApplicationSettings().then(function(){if(h.getConfigurationItem("editNewFilesImmediately")&&Pe.itemIsEditable(!1,Pe.newItemPath)){var e=Pe.newItemPath.split("/");t.$broadcast("file-editor:edit",e[e.length-1],Pe.newItemPath)}K()},function(e){K(),showResponseError(e,"RENAME_OPERATION",t,u)})}function Y(e,n){t.$broadcast("modal-prompt:clear-busy"),u(["NEW_ITEM_FAILURE_PRECEDING_MESSAGE",e],n).then(function(t){re(t.NEW_ITEM_FAILURE_PRECEDING_MESSAGE+" "+t[e])})}function J(e){return validateFileNameNonEmpty(e)?validateFileNameContainsNoSlash(e)?null:"FILE_NAME_CONTAINS_SLASH_MESSAGE":"FILE_NAME_EMPTY_MESSAGE"}function Z(e,t){u(e,t).then(re,re)}function ee(i){t.$broadcast("modal-prompt:clear-error");var r=J(i);if(null!=r)return void u(e.makeItemType).then(function(e){Z(r,{item_type:e.toLowerCase()})},function(){Z(r,{item_type:e.makeItemType.toLowerCase()})});Pe.newItemPath=o.joinNameToCurrentDirectory(i),t.$broadcast("modal-prompt:set-busy","CREATING_ACTIVITY_STATUS");var a;e.makeItemType==Be?a=n.makeDirectory(Pe.newItemPath):e.makeItemType==ke&&(a=n.putFileContents(Pe.newItemPath,"",null)),a.then(function(){Pe.makeItemSuccessCallback()},function(t){var n=e.makeItemType.toUpperCase()+"_MAKE_OPERATION",o=function(n){Pe.makeItemFailureCallback(parseErrorResponse(t,n),{item_type:e.makeItemType,action:n})};u(n).then(function(e){o(e)},function(){o(n)})})}function te(e){u(["NEW_ITEM_PROMPT_TITLE","NEW_ITEM_NAME_PLACEHOLDER"],{item_type:e}).then(function(e){t.$broadcast("modal-prompt:show",e.NEW_ITEM_PROMPT_TITLE,"",e.NEW_ITEM_NAME_PLACEHOLDER,Pe.makeItemOKCallback)})}function ne(t){e.makeItemType=t,u(t).then(function(e){te(e)},function(){te(e.makeItemType.toLowerCase().capitalizeFirstLetter())})}function oe(e){var n=[o.joinNameToCurrentDirectory(e.name)];t.$broadcast("modal-permissions:show",n,e.numericPermissions)}function ie(){if(0!=e.selectedItems.length){var n=[],i=-1;e.selectedItems.map(function(t){var r=e.directoryList[t];n.push(o.joinNameToCurrentDirectory(r.name)),-1==i?i=r.numericPermissions:r.numericPermissions!=i&&(i=0)}),t.$broadcast("modal-permissions:show",n,i)}}function re(e){t.$broadcast("modal-prompt:set-error",e)}function ae(e,i){if(t.$broadcast("modal-prompt:clear-error"),i!=e){var r=J(e);if(null!=r)return void Z(r,{item_type:"item"});t.$broadcast("modal-prompt:set-busy","RENAMING_ACTIVITY_STATUS");var a=o.joinNameToCurrentDirectory(i),s=o.joinNameToCurrentDirectory(e);n.rename(a,s).then(function(e){if(t.$broadcast("modal-prompt:clear-busy"),responseIsUnsuccessful(e))return void showResponseError(e,"RENAME_OPERATION",t,u);Pe.refreshDirectoryList(),t.$broadcast("items-moved",[[a,s]]),t.$broadcast("modal-prompt:hide")},function(e){t.$broadcast("modal-prompt:clear-busy"),showResponseError(e,"RENAME_OPERATION",t,u)}),Pe.renameSource=null}}function se(e){t.$broadcast("modal-prompt:show",e.RENAME_FILE_PROMPT_TITLE,Pe.renameSource,e.RENAME_FILE_NAME_PLACEHOLDER,Pe.fileRenameCallback)}function ce(){u(["RENAME_FILE_PROMPT_TITLE","RENAME_FILE_NAME_PLACEHOLDER"]).then(se,se)}function le(e,t){e!=o.currentDirectory&&(void 0!==e&&null!=e||(e=o.currentDirectory),Pe.changeDirectory(e,!1,t))}function ue(){o.currentDirectory=null,o.currentDirectoryList=[],r.initialDirectory=null,e.directoryList=[],a.clearHistory()}function de(e){Pe.systemVars=e,Pe.setEditableExtensions(f.getApplicationSetting("editableFileExtensions")),Pe.isLicensed=m.isLicensed(),m.isLicensed()?(Pe.allowFileCreation=!0,Pe.enableChmod=Pe.enableChmod&&!f.getApplicationSetting("disableChmod"),Pe.enableFileView=!f.getApplicationSetting("disableFileView"),Pe.enableFileEdit=Pe.enableFileView&&!f.getApplicationSetting("disableFileEdit"),Pe.contextMenuItemDisplay=f.getApplicationSetting("contextMenuItemDisplay")||{},Pe.browserColumnDisplay=f.getApplicationSetting("fileBrowserColumnDisplay")||{},Pe.archiveUploadAllowed=!0):(Pe.allowFileCreation=!1,Pe.archiveUploadAllowed=!1),y()}function fe(e){showResponseError(e,"SYSTEM_VAR_LOAD_OPERATION",t,u)}function he(e){var t=e.split(",");xe=[];for(var n=0;n<t.length;++n){var o=t[n].trim().toLowerCase();if("*"==o)return void(xe=[]);""!=o&&xe.push(o)}}function pe(e,t){if(e)return!1;if(0===xe.length)return!0;var n=t.split("/"),o=n[n.length-1],i=extractFileExtension(o);return""===i||-1!==xe.indexOf(i)}function me(){Pe.changeDirectory(parentPath(o.currentDirectory),!1)}function ge(e){t.$broadcast("modal-properties:show",e)}function ye(t){if(3==t.which&&"files"==t.target.id){e.hasPasteSource=null!=o.cutSource||null!=o.copySource,Me&&Me.dropdown("toggle");s("#extras-dropdown-button").dropdown("toggle");var n=s("#extras-dropdown");return n.css(v(t)),E(t,n),!1}}function ve(e){p.mouseDown(e)}function Ee(e,t){p.mouseMove(e,t)}function Se(e){p.mouseUp(e,Ue),Ue=!1}function Ae(e){p.mouseLeave(e)}function Te(t){for(var n=0;n<e.directoryList.length;++n)if(e.directoryList[n].name==t)return!0;return!1}function Re(e,t){var n=e;if(!Te(n))return n;var o=splitFileExtension(n);if(n=o[0]+" - "+t+o[1],!Te(n))return n;for(var i=2;;++i){var r=o[0]+" - "+t+" "+i+o[1];if(!Te(r))return r}}function Ce(e){return objectKeyIsFalse(Pe.contextMenuItemDisplay,e)}function we(e){return objectKeyIsFalse(Pe.browserColumnDisplay,e)}function _e(e){if(Pe.archiveUploadAllowed){var i=o.joinNameToCurrentDirectory(e.name);n.downloadForExtract(i).then(function(t){g.addExtract(e.name,t.data.data.fileKey,t.data.data.fileCount)},function(e){showResponseError(e,"DOWNLOAD_FOR_EXTRACT_OPERATION",t,u)})}}function Ie(){return null===qe&&(qe=allInterfaceOptionsDisabled(Ne,Pe.contextMenuItemDisplay)),qe}function Fe(e){var t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}var Pe=this,be=7,De=14,Le=20,Oe=!1,xe=[],Me=null,Ue=!1,Ne=["open","edit","view","download","cut","copy","rename","delete","chmod","properties","extract"],qe=null,$e=!0,Be="FOLDER",ke="FILE";e.directoryList=[],e.selectedItems=d.getSelectedItems(),e.directoriesToDelete=null,e.filesToDelete=null,e.isHistoryChangeDir=!1,Pe.sortName="name",Pe.sortReversed=!1,Pe.renameSource=null,Pe.rowDragStartIndex=null,Pe.isMetaDrag=!1,Pe.previousDragOverIndex=null,Pe.uiOperationFactory=o,Pe.systemVars=null,Pe.enableChmod=!0,Pe.enableFileView=!0,Pe.enableFileEdit=!0,Pe.allowFileCreation=!1,Pe.isLicensed=m.isLicensed(),Pe.archiveUploadAllowed=m.isLicensed(),Pe.contextMenuItemDisplay={},Pe.browserColumnDisplay={},Pe.didLogout=ue,Pe.doReorder=R,Pe.cancelDelete=V,Pe.performPaste=k,Pe.confirmDelete=j,Pe.deleteComplete=H,Pe.downloadSingle=O,Pe.initiateRename=ce,Pe.changeDirectory=I,Pe.downloadMultiple=L,Pe.getSelectedPaths=M,Pe.initiateMakeItem=ne,Pe.showDeleteConfirm=W,Pe.sortDirectoryList=w,Pe.downloadFileAtPath=D,Pe.fileRenameCallback=ae,Pe.initiateCutOfPaths=N,Pe.makeItemOKCallback=ee,Pe.handleReorderChange=C,Pe.initiateCopyOfPaths=U,Pe.directoryListSuccess=_,Pe.refreshDirectoryList=F,Pe.downloadSelectedFiles=x,Pe.handleChangeDirectory=le,Pe.makeItemSuccessCallback=X,Pe.makeItemFailureCallback=Y,Pe.setupContextMenuEvents=S,Pe.initiateCutOfSelectedPaths=q,Pe.initiateCopyOfSelectedPaths=B,Pe.initiateChmodOfSelectedItems=ie,Pe.initiateDeleteOfSelectedPaths=Q,Pe.initiateChmodOfItem=oe,Pe.copyItemName=Fe,Pe.rowMouseDown=ve,Pe.rowMouseMove=Ee,Pe.rowMouseUp=Se,Pe.rowMouseLeave=Ae,Pe.setEditableExtensions=he,Pe.itemIsEditable=pe,Pe.navigateUpOneLevel=me,Pe.showProperties=ge,Pe.handleBodyClick=ye,Pe.getPasteName=Re,Pe.contextMenuItemHidden=Ce,Pe.shouldHideContextMenu=Ie,Pe.browserColumnHidden=we,Pe.initiateArchiveExtract=_e,Pe.isArchiveFilename=isArchiveFilename,e.editItem=function(e){if(!m.isLicensed())return void t.$broadcast("upgrade-required-modal:display");var n=o.joinNameToCurrentDirectory(e.name);t.$broadcast("file-editor:edit",e.name,n)},e.initiateRenameOfItem=function(e){Pe.renameSource=e.name,Pe.initiateRename()},e.$on("change-directory:on-history",function(t,n){e.isHistoryChangeDir=!0,Pe.handleChangeDirectory(n)}),e.$on("change-directory",function(t,n){e.isHistoryChangeDir=!1,Pe.handleChangeDirectory(n)}),e.$on("change-directory:on-upload",function(){Pe.handleChangeDirectory(null,!0)}),e.$on("server-capability:key-changed",function(e,t,n){"changePermissions"==t&&(Pe.enableChmod=Pe.enableChmod&&n)}),e.handleClick=function(e,t){if(!(e.ctrlKey||e.metaKey||e.shiftKey)){e.stopPropagation();var n=this.item;if(n.isDirectory){var i=o.joinNameToCurrentDirectory(n.name);Pe.changeDirectory(i)}else s(e.target.parentNode.parentNode).find(".context-catcher-button").dropdown("toggle"),d.selectItem(t)}},e.$on("footer-button-click",function(e,t){switch(t){case"download":Pe.downloadSelectedFiles();break;case"cut":Pe.initiateCutOfSelectedPaths();break;case"copy":Pe.initiateCopyOfSelectedPaths();break;case"paste":Pe.performPaste();break;case"delete":Pe.initiateDeleteOfSelectedPaths();break;case"new-folder":Pe.initiateMakeItem("FOLDER");break;case"new-file":Pe.initiateMakeItem("FILE");break;case"chmod":Pe.initiateChmodOfSelectedItems()}}),e.$on("license-loaded",function(){f.getSystemConfiguration().then(de,fe)}),e.$on("login",function(){Oe=!0,y()}),e.$on("selected-items-changed",function(){e.selectedItems=d.getSelectedItems()}),e.$on("logout",function(){Pe.didLogout()}),e.$on("configuration:key-changed",function(e,t,n){"editableFileExtensions"==t&&Pe.setEditableExtensions(n)})}angular.module("MonstaFTP").controller("FileBrowserController",e),e.$inject=["$scope","$rootScope","connectionFactory","uiOperationFactory","$window","authenticationFactory","historyFactory","jQuery","$timeout","directorySortingFactory","$translate","selectedItemsFactory","configurationFactory","localConfigurationFactory","rowMouseTrackerFactory","licenseFactory","uploadFactory"]}(),function(){function e(){return{replace:!0,scope:{sortIdentifier:"&",sortName:"&",vm:"="},template:'<span ng-click="vm.handleReorderChange(sortIdentifier)" data-sort-dir="">{{ sortName|translate }}<i ng-show="vm.sortName == sortIdentifier" class="fa" ng-class="{\'fa-caret-up\': !vm.sortReversed, \'fa-caret-down\': vm.sortReversed}" aria-hidden="true"></i></span>',restrict:"E",link:function(e,t,n){e.sortName=n.sortName,e.sortIdentifier=n.sortIdentifier}}}angular.module("MonstaFTP").directive("monstaReorder",e)}(),function(){function e(){return{replace:!0,scope:{sortIdentifier:"&",sortName:"&",vm:"="},template:'<li><a href="#" ng-click="vm.handleReorderChange(sortIdentifier)" data-sort-dir="" translate>{{ sortName }}</a></li>',restrict:"E",link:function(e,t,n){e.sortName=n.sortName,e.sortIdentifier=n.sortIdentifier}}}angular.module("MonstaFTP").directive("monstaReorderMobile",e)}(),function(){function e(e){function t(e){u=!0,c=e,d=!1}function n(e,t){!u||d||t||l.mouseClick(c,e),u=!1,h=null}function o(e,t){if(u){if(d=!0,h==t)return;null==h?l.startDrag(e,t):l.mouseDrag(t),h=t}}function i(e){if(-1!=f.indexOf(e.target.tagName))return!0;h=null}function r(t){p?e.metaDraggedToIndex(t):e.draggedToIndex(t)}function a(t,n){if(-1==f.indexOf(t.target.tagName))return!0;t.preventDefault(),t.ctrlKey||t.metaKey?e.metaClickAtIndex(n):t.shiftKey?e.shiftClickAtIndex(n):"SPAN"!=t.target.tagName&&e.standardClickAtIndex(n)}function s(t,n){t.metaKey||t.ctrlKey?(p=!0,e.startMetaDraggingAtIndex(n)):(p=!1,e.startDraggingAtIndex(n))}var c,l={},u=!1,d=!1,f=["DIV","TR","TD","SPAN"],h=null,p=!1;return l.mouseDown=t,l.mouseUp=n,l.mouseMove=o,l.mouseLeave=i,l.mouseClick=a,l.mouseDrag=r,l.startDrag=s,l}angular.module("MonstaFTP").factory("rowMouseTrackerFactory",e),e.$inject=["selectedItemsFactory"]}(),function(){function e(e){function t(e,t){if(e==t)return[e];var n=1;e>t&&(n=-1);var o=[e];do{e+=n,o.push(e)}while(e!=t);return o}function n(){return p}function o(e){if(1==p.length&&p[0]==e)return p=[],void f();(-1==p.indexOf(e)||p.length>1)&&(p=[e],m=e,f())}function i(e){1==p.length&&-1!=p.indexOf(e)||(p=t(m,e),f())}function r(e){var t=p.indexOf(e);-1==t?p.push(e):p.splice(t,1),f()}function a(){p=[],f()}function s(e){a(),g=e,p=[e],f()}function c(e){p=t(g,e),f()}function l(e){y=e,h=angular.copy(p)}function u(e){for(var t=angular.copy(h),n=Math.min(e,y),o=Math.max(e,y);n<=o;++n){-1==h.indexOf(n)?t.push(n):t.splice(t.indexOf(n),1)}p=t,f()}function d(e){p=[e],f()}function f(){e.$broadcast("selected-items-changed")}var h,p=[],m=0,g=0,y=0;return{getSelectedItems:n,standardClickAtIndex:o,shiftClickAtIndex:i,metaClickAtIndex:r,clearSelection:a,startDraggingAtIndex:s,draggedToIndex:c,startMetaDraggingAtIndex:l,metaDraggedToIndex:u,selectItem:d}}angular.module("MonstaFTP").factory("selectedItemsFactory",e),e.$inject=["$rootScope"]}(),TransferStats.prototype.wasStarted=function(){this.previousSampleTime=Date.now(),this.completedItems=0,this.previousCompletedItems=0},TransferStats.prototype.updateTransferAmount=function(e){var t=e===this.totalItems;return!(!t&&Date.now()-this.previousSampleTime<TRANSFER_RATE_UPDATE_INTERVAL)&&(!(e<this.completedItems)&&(!(!t&&e-this.completedItems<=TRANSFER_ITEMS_MIN_UPDATE)&&(this.previousCompletedItems=this.completedItems,this.completedItems=e,this.addTransferRate(),!0)))},TransferStats.prototype.addTransferRate=function(){this._transferRateSamples.length==TRANSFER_RATE_SAMPLES_MAX&&this._transferRateSamples.splice(0,1),this._transferRateSamples.push(this.getInstantaneousTransferRate())},TransferStats.prototype.calculateTransferRate=function(){if(0==this._transferRateSamples.length)return 0;var e=0;return this._transferRateSamples.map(function(t){e+=t}),e/this._transferRateSamples.length},TransferStats.prototype.getInstantaneousTransferRate=function(){var e=Date.now()-this.previousSampleTime;return this.previousSampleTime=Date.now(),(this.completedItems-this.previousCompletedItems)/(e/1e3)},TransferStats.prototype.getTransferPercent=function(){return 0==this.totalItems||null==this.totalItems||null==this.completedItems?0:100*this.completedItems/this.totalItems},TransferStats.prototype.complete=function(){this.completedItems=this.totalItems},TransferStats.prototype.hasBeenStarted=function(){return-1!=this.previousSampleTime},function(){function e(e,t,n,o,i,r,a,s,c,l){function u(){e.currentVersion&&window.MONSTA_LATEST_VERSION&&(e.newVersionAvailable=versionIsLessThan(e.currentVersion,window.MONSTA_LATEST_VERSION))}function d(){O.value=null,O.click()}function f(){if(this.files&&this.files.length){var e=this.items;F.isArchiveUpload&&!R(this.files)||(void 0!=e?r.handleItemsBasedUpload(e,!!F.isArchiveUpload&&null):r.handleFilesBasedUpload(this.files,!!F.isArchiveUpload&&null))}}function h(e){t.$broadcast("modal-error:show",e)}function p(){if(null===b){var e=document.createElement("input");b="webkitdirectory"in e||"mozdirectory"in e||"odirectory"in e||"msdirectory"in e||"directory"in e}return b}function m(){if(!p())return void a("FOLDER_UPLOAD_NOT_SUPPORTED_MESSAGE").then(h,h);x.value=null,x.click()}function g(t){return"show-editor"==t?e.editorActive:"paste"==t?e.hasPasteSource:-1==P.indexOf(t)||0!=e.selectedItemsCount}function y(e){a("FETCHING_ACTIVITY_STATUS").then(function(e){t.$broadcast("modal-prompt:set-busy",e)}),o.fetchRemoteFile(e,n.currentDirectory).then(function(e){if(responseIsUnsuccessful(e))return void showResponseError(e,"REMOTE_FILE_FETCH_OPERATION",t,a);t.$broadcast("change-directory"),t.$broadcast("modal-prompt:hide")},function(e){showResponseError(e,"REMOTE_FILE_FETCH_OPERATION",t,a),t.$broadcast("modal-prompt:clear-busy")})}function v(e){t.$broadcast("modal-prompt:set-error",e)}function E(e){if(t.$broadcast("modal-prompt:clear-error"),!basicURLValidate(e))return void a("URL_INVALID_MESSAGE").then(v,v);var n=e.replace(/^\s\s*/,"");F.performRemoteFetch.call(F,n)}function S(){a(["FETCH_FILE_PROMPT_TITLE","FETCH_FILE_URL_PLACEHOLDER"]).then(function(e){t.$broadcast("modal-prompt:show",e.FETCH_FILE_PROMPT_TITLE,null,e.FETCH_FILE_URL_PLACEHOLDER,F.remoteFetchCallback)})}function A(t){e.editorActive=0!=t}function T(){t.$broadcast("file-editor:show")}function R(e){var n=null;return 1!==e.length?n="MULTIPLE_FILE_ARCHIVE_ERROR":isArchiveFilename(e[0].name)||(n="INVALID_TYPE_ARCHIVE_ERROR"),null==n||(t.$broadcast("modal-error:show",n),!1)}function C(e){if(F.isLoggedIn){if("upload-file"===e)return F.isArchiveUpload=!1,void F.handleUpload();if("upload-folder"===e)return F.isArchiveUpload=!1,void F.handleUploadFolder();if("upload-archive"===e)return void(l.isLicensed()?(F.isArchiveUpload=!0,F.handleUpload()):t.$broadcast("upgrade-required-modal:display"));if("fetch-file"===e)return void(l.isLicensed()?F.initiateRemoteFetch():t.$broadcast("upgrade-required-modal:display"));if("show-editor"===e){if(!F.allowAction(e))return;return void F.showEditor()}if("new-file"===e&&!l.isLicensed())return void t.$broadcast("upgrade-required-modal:display");F.allowAction(e)&&t.$broadcast("footer-button-click",e)}}function w(){allInterfaceOptionsDisabled(D,F.itemDisplay)&&document.getElementsByTagName("body")[0].classList.add("no-footer")}function _(e){return!!F.itemDisplay.hasOwnProperty(e)&&!1===F.itemDisplay[e]}function I(){t.$broadcast("modal-update:show")}var F=this,P=["chmod","cut","copy","download"],b=null,D=["chmod","cut","copy","paste","delete","fetch-file","upload","upload-file","upload-folder","upload-archive","download","new-item","new-file","new-folder","show-editor","session-information","remote-server","username","upload-limit","version","new-version-alert"],L=0;F.isArchiveUpload=!1,e.selectedItemsCount=0,e.hasPasteSource=!1,e.maxUploadBytes=MAX_UPLOAD_BYTES,e.currentUsername=null,e.currentHost=null,e.currentVersion=0,e.newVersionAvailable=!1,e.editorActive=!1,F.enableChmod=!0,F.enableFileView=l.isLicensed(),F.enableFileEdit=!0,F.showRemoteServerAddress=!0,F.isLicensed=!1,F.isLoggedIn=!1,F.itemDisplay={},F.sessionDisplayForce=!1,F.handleUpload=d,F.handleUploadFolder=m,F.allowAction=g,F.performRemoteFetch=y,F.remoteFetchCallback=E,F.initiateRemoteFetch=S,F.onEditorHide=A,F.showEditor=T,F.validateArchiveUpload=R,F.buttonClick=C,F.itemHidden=_,F.showUpdateModal=I;var O=document.getElementById("upload-placeholder"),x=document.getElementById("upload-folder-placeholder");O&&(O.addEventListener("change",f),x.addEventListener("change",f)),e.$on("selected-items-changed",function(){e.selectedItemsCount=s.getSelectedItems().length}),e.$on("paste-source:set",function(){e.hasPasteSource=!0}),e.$on("paste-source:cleared",function(){e.hasPasteSource=!1}),e.$on("license-loaded",function(){F.isLicensed=l.isLicensed(),c.getSystemConfiguration().then(function(){F.isLicensed&&(F.enableChmod=F.enableChmod&&!c.getApplicationSetting("disableChmod"),F.enableFileView=!c.getApplicationSetting("disableFileView"),F.enableFileEdit=F.enableFileView&&!c.getApplicationSetting("disableFileEdit"),F.showRemoteServerAddress=!c.getApplicationSetting("disableRemoteServerAddressDisplay"),F.itemDisplay=normalizeFooterDisplayOptions(c.getApplicationSetting("footerItemDisplay")||{}),L=c.getApplicationSetting("resumeSessionInfoDisplaySeconds"),w())},function(e){})}),e.$on("login",function(t,n){var o=i.getActiveConfiguration(),r=null;o.username?r=o.username:o.remoteUsername&&(r=o.remoteUsername),e.currentUsername=r,e.currentHost=o.host||null,e.editorActive=!1,F.isLoggedIn=!0,"resume"===n&&(_("session-information")||L<=0||(F.sessionDisplayForce=!0,window.setTimeout(function(){F.sessionDisplayForce=!1,e.$apply()},1e3*L)))}),e.$on("logout",function(){e.currentUsername=null,e.currentHost=null,e.editorActive=!1,F.isLoggedIn=!1}),e.$on("file-editor:hide",function(e,t){F.onEditorHide(t)}),e.$on("server-capability:key-changed",function(e,t,n){"changePermissions"===t&&(F.enableChmod=F.enableChmod&&n)}),document.addEventListener("latestVersionLoadEVent",function(){u()}),c.getSystemConfiguration().then(function(t){MAX_UPLOAD_BYTES=t.maxFileUpload,e.maxUploadBytes=MAX_UPLOAD_BYTES,e.currentVersion=t.version,u()},function(e){})}angular.module("MonstaFTP").controller("FooterController",e),e.$inject=["$scope","$rootScope","uiOperationFactory","connectionFactory","authenticationFactory","uploadUIFactory","$translate","selectedItemsFactory","configurationFactory","licenseFactory"]}(),function(){function e(e){return{replace:!0,scope:{iconClass:"&",itemTitle:"&",activeCondition:"<?",disabledCondition:"<?",identifier:"&",vm:"=",hideCondition:"<?"},template:'<button class="fa fa-fw {{ iconClass }} {{ (activeCondition && vm.isLoggedIn) ? \'active\' : \'inactive\' }}" title="{{ buttonTitle|translate }}" ng-click="vm.buttonClick(buttonIdentifier)" ng-class="{\'disabled-link\': disabledCondition} " ng-hide="hideCondition" ng-bind-html="trust(extraIcon)"></button>',restrict:"E",link:function(t,n,o){t.trust=e.trustAsHtml,"new-folder-plus"===o.iconClass?(t.iconClass="fa-folder-o fa-stack",t.extraIcon="<i class='fa fa-plus fa-stack-1x footer-icon-stack'>"):(t.iconClass=o.iconClass,t.extraIcon=""),t.buttonTitle=o.itemTitle,void 0==o.activeCondition&&(t.activeCondition=!0),void 0==o.disabledCondition&&(t.disabledCondition=!1),t.buttonIdentifier=o.identifier,void 0==o.hideCondition?t.hideCondition=!1:t.hideCondition=o.hideCondition,t.$watch("vm.itemDisplay",function(e,n){t.vm.itemHidden(t.buttonIdentifier)&&(t.hideCondition=!0)})}}}angular.module("MonstaFTP").directive("monstaFooterButton",e),e.$inject=["$sce"]}(),function(){function e(){return{replace:!0,scope:{iconClass:"&",itemTitle:"&",activeCondition:"<?",disabledCondition:"<?",identifier:"&",vm:"=",hideCondition:"<?"},template:'<li class="{{ (activeCondition && vm.isLoggedIn) ? \'active\' : \'inactive\'}}" data-name="{{ buttonIdentifier }}" ng-click="vm.buttonClick(buttonIdentifier)" ng-hide="hideCondition"><a href="#" ng-class="{\'disabled-link\': disabledCondition }" ondragstart="return false;"><i class="fa fa-fw {{ iconClass }}"></i> {{ buttonTitle|translate }} </a></li>',restrict:"E",link:function(e,t,n){e.iconClass=n.iconClass,e.buttonTitle=n.itemTitle,void 0==n.activeCondition&&(e.activeCondition=!0),e.buttonIdentifier=n.identifier,void 0==n.hideCondition&&(e.hideCondition=!1),void 0==n.disabledCondition&&(e.disabledCondition=!1),e.$watch("vm.itemDisplay",function(t,n){e.vm.itemHidden(e.buttonIdentifier)&&(e.hideCondition=!0)})}}}angular.module("MonstaFTP").directive("monstaFooterMenuItem",e)}(),function(){function e(e,t,n,o,i){function r(e){e.map(function(e){t.removeEntry(e)})}function a(){var e=t.getUniqueHistory();s.sortedHistory=e.sort()}e.history=[];var s=this;s.sortedHistory=[],e.$on("directory-changed",function(){a()}),e.$on("history-changed",function(){a()}),e.historyClick=function(e){n.$broadcast("change-directory",e)},e.$on("items-deleted",function(e,t){r(t)}),e.$on("items-moved",function(e,t){for(var n=[],o=0;o<t.length;++o)n.push(t[o][0]);r(n)}),e.$on("license-loaded",function(){o.isLicensed()&&i.getSystemConfiguration().then(function(){i.getApplicationSetting("hideHistoryBar")&&document.getElementsByTagName("body")[0].classList.add("no-history")},function(){})})}angular.module("MonstaFTP").controller("HistoryController",e),e.$inject=["$scope","historyFactory","$rootScope","licenseFactory","configurationFactory"]}(),function(){function e(e){var t=function(e){return e+("/"!=e.substr(e.length-1)?"/":"")};return{_fullHistory:[],_historyIndex:-1,getFullHistory:function(){return this._fullHistory},getFullHistoryCount:function(){return this._fullHistory.length},addEntry:function(n){n=t(n),this._historyIndex!=this._fullHistory.length-1&&this._fullHistory.splice(this._historyIndex+1),this._fullHistory.push(n),++this._historyIndex,e.$broadcast("history-changed")},removeEntry:function(n){n=t(n);for(var o=!1,i=this._fullHistory.length-1;i>=0;--i){var r=this._fullHistory[i];r.length<n.length||r.substr(0,n.length)==n&&(this._fullHistory.splice(i,1),o=!0)}o&&e.$broadcast("history-changed")},getFullHistoryItem:function(e){return this._fullHistory[e]},getHistoryIndex:function(){return this._historyIndex},setHistoryIndex:function(t){return this._historyIndex=t,e.$broadcast("history-changed"),this._fullHistory[t]},hasPreviousHistoryItem:function(){return this._historyIndex>0},hasNextHistoryItem:function(){return this._historyIndex>-1&&this._historyIndex<this._fullHistory.length-1},navigateBack:function(){if(this.hasPreviousHistoryItem())return this.setHistoryIndex(this.getHistoryIndex()-1)},navigateForward:function(){if(this.hasNextHistoryItem())return this.setHistoryIndex(this.getHistoryIndex()+1)},getUniqueHistory:function(){if(0==this.getFullHistoryCount())return[];for(var e=[],t=this.getFullHistoryCount();t-->0;){var n=this.getFullHistoryItem(t);-1==e.indexOf(n)&&e.push(n)}return e},clearHistory:function(){this._fullHistory=[],this._historyIndex=-1,e.$broadcast("history-changed")}}}angular.module("MonstaFTP").factory("historyFactory",e),e.$inject=["$rootScope"]}(),function(){function e(e,t,n,o,i){function r(){d.canGoBack=n.hasPreviousHistoryItem(),d.canGoForward=n.hasNextHistoryItem()}function a(e){return!!d.itemDisplay.hasOwnProperty(e)&&!1===d.itemDisplay[e]}function s(){if(d.canGoBack){var e=n.navigateBack();e&&t.$broadcast("change-directory:on-history",e)}}function c(){if(d.canGoForward){var e=n.navigateForward();e&&t.$broadcast("change-directory:on-history",e)}}function l(){t.$broadcast("change-directory")}function u(){if(allInterfaceOptionsDisabled(f,d.itemDisplay)){document.getElementsByTagName("body")[0].classList.add("no-header")}}var d=this,f=["forward","back","refresh"];d.canGoBack=!1,d.canGoForward=!1,d.itemDisplay={},d.navigateBack=s,d.navigateForward=c,d.refresh=l,d.itemHidden=a,e.$on("history-changed",function(){r()}),e.$on("directory-changed",function(){r()}),e.$on("license-loaded",function(){o.isLicensed()&&i.getSystemConfiguration().then(function(){d.itemDisplay=i.getApplicationSetting("headerItemDisplay")||{},u()},function(){})})}angular.module("MonstaFTP").controller("HeaderController",e),e.$inject=["$scope","$rootScope","historyFactory","licenseFactory","configurationFactory"]}(),function(){function e(e){return e.jQuery}angular.module("MonstaFTP").factory("jQuery",e),e.$inject=["$window"]}(),function(){function e(e,t,n,o,i,r,a){function s(){f.configURL=o.getConfigURL(f.type,f.configuration),f.supportsCopy=d(),n(h).modal("show")}function c(){n(h).modal("hide"),e.$broadcast("modal-login:show")}function l(e,t){alert(t),e.select()}function u(){var e=i.find("textarea")[0];e.select();var t=!1;try{t=document.execCommand("copy")}catch(e){t=!1}t||a("COPY_FAILURE_MESSAGE").then(function(t){l(e,t)},function(){l(e,"Unfortunately your browser does not support automatic copying, please copy the address from the text box.")})}function d(){var e=r.navigator.userAgent;return!!/chrome/i.test(e)||!/safari/i.test(e)&&(void 0!=document.queryCommandEnabled&&document.queryCommandEnabled("copy"))}var f=this,h="#modal-login-link";f.show=s,f.hide=c,f.copy=u,t.$on("modal-login-link:show",function(e,t,n){f.type=t,f.configuration=n,f.show()}),n(h).on("shown.bs.modal",function(){n(this).find("textarea").select()})}angular.module("MonstaFTP").controller("ModalLoginLinkController",e),e.$inject=["$rootScope","$scope","jQuery","requestLoginFactory","$element","$window","$translate"]}(),function(){function e(e,t){return{isNullLicense:!0,email:null,version:null,expiryDate:null,purchaseDate:null,productEdition:-1,getLicense:function(){var t=this;e.getLicense().then(function(e){if(responseIsUnsuccessful(e))return void t.handleGetFailure.call(t,e);t.handleGetSuccess.call(t,e)},function(e){t.handleGetFailure.call(t,e)})},handleGetSuccess:function(e){var n=e.data.data;null==n?this.isNullLicense=!0:(this.email=n.email,this.version=n.version,this.expiryDate=1e3*n.expiryDate,this.purchaseDate=1e3*n.purchaseDate,this.isTrial=n.isTrial,this.isNullLicense=!1,this.productEdition=n.productEdition?n.productEdition:0),t.$broadcast("license-loaded");var o=document.createEvent("CustomEvent");o.initEvent("lload",!0,!0),o.lType=this.productEdition,document.dispatchEvent(o)},handleGetFailure:function(e){t.$broadcast("modal-error:show",parseErrorResponse(e,"license reading"),null,{action:"license reading"})},isLicensed:function(){return!this.isNullLicense&&!this.isLicenseExpired()},isLicenseExpired:function(){return!this.isNullLicense&&(null!=this.expiryDate&&Date.now()>this.expiryDate)},isTrialLicense:function(){return!this.isNullLicense&&!0===this.isTrial}}}angular.module("MonstaFTP").factory("licenseFactory",e),e.$inject=["connectionFactory","$rootScope"]}(),function(){function e(e,t,n,o,i,r,a,s,c){function l(t){e.storedAuthenticationErrorMessage=t}function u(e){o.$broadcast("modal-confirm:show",e,ce.removeProfile)}function d(){var t=[["ftp","FTP"],["sftp","SFTP/SCP"]];DEBUG&&t.push(["mock","Mock"]),e.connectionTypes=[];for(var n=0;n<t.length;++n)X(t[n][0])&&e.connectionTypes.push(t[n]);for(e.configuration={},e.connectionTypes.length&&(e.connectionType=e.connectionTypes[0][0]),n=0;n<e.connectionTypes.length;++n)e.configuration[e.connectionTypes[n][0]]={}}function f(){i(se).modal("hide")}function h(){var t={};ce.isAuthenticated=n.isAuthenticated,n.isAuthenticated?(t.backdrop=!0,t.keyboard=!0):(t.backdrop="static",t.keyboard=!1),ce.updateHasServerSavedAuth();var o=i(se);ue?(o.data("bs.modal").options.backdrop=t.backdrop,o.data("bs.modal").options.keyboard=t.keyboard):(o.modal(t),ue=!0),g_isNewWindowsInstall&&o.on("shown.bs.modal",function(){ce.showMissingLanguageMessage="LOGIN"===i("#modal-login-label").text(),e.$apply()}),o.modal("show")}function p(t,n){"connection-display"==n?e.connectionErrorMessage=t:"saved-profile-display"==n?e.storedAuthenticationErrorMessage=t:o.$broadcast("modal-error:show",t)}function m(e,t,n,o,i){var r;null==e?r=parseErrorResponse(t,n):(r=e.errorName,void 0!=e.context&&(o=e.context)),o.action=n,a(r,o).then(function(e){p(e,i)},function(){p(r,i)})}function g(e,t,n){var o=getLocalizedErrorFromResponse(e),i={};a(t).then(function(t){m(o,e,t,i,n)},function(){m(o,e,t,i,n)})}function y(t){var o=e.configuration,i=e.connectionType;"resume"===t?o[i].initialDirectory=n.initialDirectory:n.initialDirectory=o[i].initialDirectory}function v(){t.writeSavedAuth(e.metaConfiguration.masterPassword,e.savedAuthentication).then(function(e){responseIsUnsuccessful(e)&&ce.handleError(e,"saving profile")},function(e){ce.handleError(e,"saving profile")})}function E(){null!=e.savedAuthentication&&"object"==typeof e.savedAuthentication||(e.savedAuthentication={}),void 0==e.savedAuthentication[e.connectionType]&&(e.savedAuthentication[e.connectionType]=[]);var t=angular.copy(e.configuration[e.connectionType]);t.name=e.metaConfiguration.enteredProfileName;var n=e.savedAuthentication[e.connectionType];"new"==e.metaConfiguration.savedProfileIndex?n.push(t):n[e.metaConfiguration.savedProfileIndex]=t,ce.writeAuthenticationToServer()}function S(){e.savedAuthentication[e.connectionType].splice(e.metaConfiguration.savedProfileIndex,1),e.metaConfiguration.savedProfileIndex=Math.min(e.metaConfiguration.savedProfileIndex,e.savedAuthentication[e.connectionType].length-1),ce.writeAuthenticationToServer()}function A(){!isEmpty(e.metaConfiguration.masterPassword)&&e.metaConfiguration.saveAuthentication&&e.hasServerSavedAuthentication&&ce.saveCurrentAuthentication()}function T(e){return void 0==e.data?{}:void 0==e.data.data?{}:void 0==e.data.data.serverCapabilities?{}:e.data.data.serverCapabilities}function R(t,i){var r=T(i),a=e.configuration,c=e.connectionType;for(var l in r)"initialDirectory"!==l||null===r[l]?r.hasOwnProperty(l)&&s.setServerCapability(l,r[l]):isEmpty(a[c].initialDirectory)&&(a[c].initialDirectory=r[l],n.initialDirectory=r[l]);n.postLogin(),ce.initiateAuthenticationSave(),ce.hide(),o.$broadcast("login",t)}function C(t,o){if("resume"===t||"url"===t){if("url"===t){var i=s.getApplicationSetting("postLogoutUrl"),a=s.getApplicationSetting("disableLoginForm"),c=s.getApplicationSetting("loginFailureRedirect");if(r.isLicensed()&&null===c&&null!==i&&!0===a&&(c=i),null!=c&&""!==c){var l=-1===c.indexOf("?")?"?":"&",u=getLocalizedErrorFromResponse(o),d=null===u?"":u.errorName;window.location=c+l+"MFTP_ERROR="+encodeURIComponent(d)}e.configuration[e.connectionType].password=null,n.configuration[e.connectionType].password=null}ce.show()}else ce.handleError(o,"authentication","connection-display")}function w(t){var o=angular.copy(e.configuration);ce.applyRestrictionsToConfiguration(o),n.configuration=o,"resume"!=t&&(n.initialDirectory=o[e.connectionType].initialDirectory),n.connectionType=e.connectionType,n.rememberLogin=e.metaConfiguration.rememberLogin,n.hasServerSavedAuthentication=e.hasServerSavedAuthentication}function _(e,t){responseIsUnsuccessful(t)?ce.handleAuthenticationFailure(e,t):ce.handleAuthenticationSuccess(e,t)}function I(e){t.testConnectAndAuthenticate(!0).then(function(t){ce.successCallback(e,t)},function(t){ce.handleAuthenticationFailure(e,t)})}function F(e){ce.setupInitialDirectory(e),ce.transferConfigToAuthFactory(e),ce.handleTestConfiguration(e)}function P(){e.connectionType=n.connectionType||e.connectionTypes[0][0],X(e.connectionType)||(e.connectionType=e.connectionTypes[0][0]),e.metaConfiguration.rememberLogin=n.rememberLogin,e.hasServerSavedAuthentication=n.hasServerSavedAuthentication}function b(t){e.configuration=angular.copy(n.configuration);var o=ce.applyRestrictionsToConfiguration(e.configuration);t||!o&&!n.isAuthenticated?ce.show():ce.testConfiguration("resume"),n.clearAuthConfiguration()}function D(t,o){var i={};i[t.type]=t.configuration,n.configuration=angular.copy(i),e.configuration=angular.copy(i),ce.applyRestrictionsToConfiguration(i),e.connectionType=t.type,o?ce.show():ce.testConfiguration("url")}function L(){var t=angular.copy(g_monstaPostEntryVars);delete t.settings,n.configuration=angular.copy(t),e.configuration=angular.copy(t),ce.applyRestrictionsToConfiguration(t),e.connectionType=t.type,ce.testConfiguration("url")}function O(){t.checkSavedAuthExists().then(function(t){e.hasServerSavedAuthentication=!0===t.data.data},function(){ce.isAuthenticated=!1,e.hasServerSavedAuthentication=!1})}function x(){e.configuration.ftp&&(e.configuration.ftp.passive=!0)}function M(t){ce.addDefaultsToConfig(),ce.applyRestrictionsToConfiguration(e.configuration)&&!t?F("resume"):ce.show()}function U(e){var t=s.getApplicationSetting("postLogoutUrl"),o=s.getApplicationSetting("disableLoginForm");e=!!e,ce.buildDefaultConfiguration(),n.loadSettings(),ce.transferConfigFromAuthFactory();var i=r.isLicensed();i&&(ce.shouldShowPoweredBy=!1,1===r.productEdition&&(ce.showPasswordManagementButton=g_forgotPasswordAvailable&&!0===ce.applicationSettings.enableForgotPassword||g_resetPasswordAvailable&&!0===ce.applicationSettings.enableResetPassword),ce.showLoginLinkButton=!0!==ce.applicationSettings.disableLoginLinkButton);var a=null;le&&i&&(a=c.getConfigFromCurrentURL()),g_isMonstaPostEntry||null!==a||!0!==o||null===t||(window.location=t),null!=a?ce.initWithURLConfig(a,e):le&&i&&g_isMonstaPostEntry?ce.initWithPostedConfig():n.hasStoredAuthenticationDetails()?ce.initWithStoredAuth(e):ce.initWithDefaultAuth(e)}function N(){e.masterPasswordValid=!0,e.hasServerSavedAuthentication=!0}function q(t){e.savedAuthentication=t.data.data,e.masterPasswordValid=!0}function $(t){e.masterPasswordValid=!1,ce.handleError(t,"reading/writing the profile file","saved-profile-display")}function B(){for(var n={},o=0;o<e.connectionTypes.length;++o)n[e.connectionTypes[o][0]]=[];t.writeSavedAuth(e.metaConfiguration.masterPassword,n).then(function(e){responseIsUnsuccessful(e)?ce.handleAuthFileFailure(e):ce.handleCreateAuthSuccess(e)},function(e){ce.handleAuthFileFailure(e)})}function k(){t.readSavedAuth(e.metaConfiguration.masterPassword).then(function(e){responseIsUnsuccessful(e)?ce.handleAuthFileFailure(e):ce.handleLoadSavedAuthSuccess(e)},function(e){ce.handleAuthFileFailure(e)})}function G(t){e.configuration[e.connectionType]=angular.copy(e.savedAuthentication[e.connectionType][t]),e.metaConfiguration.enteredProfileName=e.configuration[e.connectionType].name}function H(){e.configuration[e.connectionType]={},e.metaConfiguration.enteredProfileName=null,ce.addDefaultsToConfig()}function j(e){return null==ce.connectionRestrictions||"object"!=typeof ce.connectionRestrictions||(!ce.connectionRestrictions.hasOwnProperty(e)||!angular.isArray(ce.connectionRestrictions[e].host))}function V(t,n){void 0===e.configuration[t]&&(e.configuration[t]={}),0!==n.length&&-1===n.indexOf(e.configuration[t].host)&&(e.configuration[t].host=n[0])}function z(e){return j(e)?[]:(V(e,ce.connectionRestrictions[e].host),ce.connectionRestrictions[e].host)}function W(e,t){return null==ce.connectionRestrictions||"object"!=typeof ce.connectionRestrictions||(!ce.connectionRestrictions.hasOwnProperty(e)||(!("host"!==t||!angular.isArray(ce.connectionRestrictions[e][t]))||!ce.connectionRestrictions[e].hasOwnProperty(t)))}function Q(e){if(null==ce.connectionRestrictions||"object"!=typeof ce.connectionRestrictions)return!1;var t=!1;for(var n in ce.connectionRestrictions)if(ce.connectionRestrictions.hasOwnProperty(n)&&e.hasOwnProperty(n)){var o=ce.connectionRestrictions[n];null!=o&&"object"==typeof ce.connectionRestrictions&&(t=K(e,n,o))}return t}function K(e,t,n){var o=e[t],i=!1;for(var r in n)if(n.hasOwnProperty(r)){if(!0===n[r]||1===n[r])e[t][r]=null;else{var a=n[r];if("host"===r&&angular.isArray(a))continue;if(null!=a){var s=new MessageFormat("en").compile(a);a=s({username:o.remoteUsername||o.username})}else if("initialDirectory"==r)return!1;e[t][r]=a}i=!0}return i}function X(e){return null==ce.connectionRestrictions||"object"!=typeof ce.connectionRestrictions||("[object Array]"!=Object.prototype.toString.call(ce.connectionRestrictions.types)||(0==ce.connectionRestrictions.types.length||-1!=ce.connectionRestrictions.types.indexOf(e)))}function Y(){return!0!==ce.applicationSettings.disableMasterLogin&&!re("master-login")&&r.isLicensed()}function J(){o.$broadcast("modal-login-link:show",e.connectionType,e.configuration[e.connectionType]),ce.hide()}function Z(){return""!==e.metaConfiguration.savedProfileIndex&&null!==e.metaConfiguration.savedProfileIndex}function ee(e,t){return void 0==e?"":!t&&e.name?e.name:null==e.host||null==e.username&&null==e.remoteUsername?"":(e.host||"host")+" / "+(e.username||e.remoteUsername||"username")}function te(){return null==e||null==e.configuration||null==e.connectionType?"":ee(e.configuration[e.connectionType],!0)}function ne(){return void 0!=e.configuration.sftp&&(0==ce.sshAgentAuthEnabled&&"Agent"==e.configuration.sftp.authenticationModeName||0==ce.sshKeyAuthEnabled&&"PublicKeyFile"==e.configuration.sftp.authenticationModeName)}function oe(t){e.connectionType=t,window.setTimeout(function(){e.$apply(function(){e.handleProfileChange()})})}function ie(){ce.hide(),o.$broadcast("modal-password-management:show")}function re(e){return!!r.isLicensed()&&objectKeyIsFalse(ce.loginItemDisplay,e)}function ae(){!1===e.metaConfiguration.rememberLogin&&n.clearAuthConfiguration()}var se="#modal-login",ce=this,le=!0,ue=!1;e.connectionErrorMessage=null,e.storedAuthenticationErrorMessage=null,e.defaults=g_ConnectionDefaults,e.metaConfiguration={rememberLogin:!1,masterPassword:null,savedProfileIndex:null,enteredProfileName:null},e.hasServerSavedAuthentication=!1,e.savedAuthentication=null,e.licenseFactory=r,e.metaConfiguration.saveAuthentication=!0,e.systemConfiguration={},e.configuration={},ce.connectionRestrictions={},ce.applicationSettings={},ce.isAuthenticated=!1,ce.showMissingLanguageMessage=!1,ce.ftpConnectionAvailable=g_ftpConnectionAvailable,ce.showPasswordManagementButton=!1,ce.showLoginLinkButton=!1,ce.loginItemDisplay={},ce.shouldShowPoweredBy=!0,ce.buildDefaultConfiguration=d,ce.hide=f,ce.show=h,ce.handleError=g,ce.setupInitialDirectory=y,ce.writeAuthenticationToServer=v,ce.saveCurrentAuthentication=E,ce.removeProfile=S,ce.initiateAuthenticationSave=A,ce.handleAuthenticationSuccess=R,ce.handleAuthenticationFailure=C,ce.transferConfigToAuthFactory=w,ce.successCallback=_,ce.handleTestConfiguration=I,ce.testConfiguration=F,ce.transferConfigFromAuthFactory=P,ce.initWithStoredAuth=b,ce.updateHasServerSavedAuth=O,ce.addDefaultsToConfig=x,ce.initWithDefaultAuth=M,ce.init=U,ce.handleCreateAuthSuccess=N,ce.handleLoadSavedAuthSuccess=q,ce.handleAuthFileFailure=$,ce.performCreateAuthFile=B,ce.initiateLoadOfAuthFile=k,ce.loadProfileAtIndex=G,ce.loadNewProfile=H,ce.configurationSettable=W,ce.applyRestrictionsToConfiguration=Q,ce.shouldShowProfiles=Y,ce.showLoginLink=J,ce.initWithURLConfig=D,ce.initWithPostedConfig=L,ce.profileIsSelected=Z,ce.getProfileName=ee,ce.getDefaultProfileName=te,ce.showDisabledSFTPAuthMessage=ne,ce.selectTab=oe,ce.showPasswordManager=ie,ce.loginItemHidden=re,ce.hostEntryIsText=j,ce.getHostOptions=z,ce.rememberLoginToggle=ae,e.connect=function(){e.connectionErrorMessage=null,ce.testConfiguration("form")},e.handleLoginKeyPress=function(t){13==t.which&&e.connect()},e.$on("logout",function(){le=!1;var e=!1;if(r.isLicensed()){var t=s.getApplicationSetting("postLogoutUrl");null!=t&&(e=!0,window.setTimeout(function(){window.location=t},200))}e||ce.init(!0)}),e.$on("modal-login:show",function(){ce.show()}),e.handleAuthGo=function(){if(e.connectionErrorMessage=null,isEmpty(e.metaConfiguration.masterPassword))return void a("PROFILE_SET_PASSWORD_ERROR").then(l,l);e.storedAuthenticationErrorMessage="",e.hasServerSavedAuthentication?ce.initiateLoadOfAuthFile():ce.performCreateAuthFile()},e.masterPasswordKeypress=function(t){13===t.which&&e.handleAuthGo()},e.handleProfileChange=function(){e.connectionErrorMessage=null;var t=e.metaConfiguration.savedProfileIndex;if("new"==t)return void ce.loadNewProfile();var n=parseInt(t);isNaN(n)||ce.loadProfileAtIndex(n)},e.initiateProfileDelete=function(){a("PROFILE_DELETE_CONFIRM_MESSAGE").then(u,u)},e.shouldHideDeleteButton=function(){return!Y()||isNaN(parseInt(e.metaConfiguration.savedProfileIndex))},e.$on("license-loaded",function(){ce.init()}),s.getSystemConfiguration().then(function(t){ce.sshAgentAuthEnabled=t.sshAgentAuthEnabled,ce.sshKeyAuthEnabled=t.sshKeyAuthEnabled,e.systemConfiguration=t,ce.applicationSettings=t.applicationSettings,ce.connectionRestrictions=t.applicationSettings.connectionRestrictions,ce.loginItemDisplay=s.getApplicationSetting("loginItemDisplay")||{},r.getLicense()},function(e){r.getLicense()})}angular.module("MonstaFTP").controller("LoginPanelController",e),e.$inject=["$scope","connectionFactory","authenticationFactory","$rootScope","jQuery","licenseFactory","$translate","configurationFactory","requestLoginFactory"]}(),function(){function e(e,t,n){function o(e,t,n){return e.replace(new RegExp(t,"g"),n)}function i(){t(l).modal("show")}function r(e){null!=e&&t(l).on("hidden.bs.modal",function(){t(l).off("hidden.bs.modal"),null!=e&&e()}),t(l).modal("hide")}function a(e){r(c.callbacks[e][1])}function s(){r(c.cancelCallback)}var c=this,l="#modal-choice";c.callbacks=[],c.cancelCallback=null,c.title=null,c.message=null,c.show=i,c.handleCallback=a,c.handleCancel=s,e.$on("modal-choice:show",function(t,i,r,a,s){i=o(i,"TAG_STRONG_START","<strong>"),i=o(i,"TAG_STRONG_END","</strong>"),r=o(r,"TAG_STRONG_START","<strong>"),r=o(r,"TAG_STRONG_END","</strong>"),c.title=i,c.message=r,c.callbacks=s,c.cancelCallback=a,n(function(){e.$apply(function(){c.show()})})})}angular.module("MonstaFTP").controller("ModalChoiceController",e),e.$inject=["$scope","jQuery","$timeout"]}(),function(){function e(e,t,n,o,i,r){function a(){d.openSslAvailable&&(d.licenseUpdateError=null,i.updateLicense(d.models.license).then(function(){t.getLicense(),d.models.license=""},function(e){var t=e.data.localizedErrors[0];r(t.errorName,t.context).then(function(e){d.licenseUpdateError=e},function(){d.licenseUpdateError=errorMessage})}))}function s(){d.formattedExpiryDate=o("date")(t.expiryDate,"d MMMM, yyyy"),d.licenseExpired=t.isLicenseExpired(),d.isLicensed=t.isLicensed(),d.isTrialLicense=t.isTrialLicense(),d.isLicensed?1==t.productEdition?d.productEditionShortName="HOST_EDITION":d.productEditionShortName="BUSINESS_EDITION":d.productEditionShortName="STARTER_EDITION"}function c(){s(),e(u).modal("show")}function l(e){d.activeTab=e,window.setTimeout(function(){n.$apply()})}var u="#modal-addons",d=this;d.show=c,d.updateLicense=a,d.selectTab=l,d.models={license:""},d.licenseUpdateError=null,d.activeTab="addon-current",d.productEditionShortName="STARTER_EDITION",d.openSslAvailable=g_openSslAvailable,n.$on("modal-addons:show",function(){d.show()}),n.$on("license-loaded",function(){s()})}angular.module("MonstaFTP").controller("ModalAddonsController",e),e.$inject=["jQuery","licenseFactory","$scope","$filter","connectionFactory","$translate"]}(),function(){function e(e,t){function n(){t(r).modal("hide"),null!=a.okCallback&&(a.okCallback(),a.okCallback=null)}function o(){t(r).modal("hide"),null!=a.cancelCallback&&(a.cancelCallback(),a.cancelCallback=null)}function i(){t(r).modal("show")}var r="#modal-confirm",a=this;a.message="",a.okCallback=null,a.cancelCallback=null,a.show=i,a.ok=n,a.cancel=o,e.$on("modal-confirm:show",function(e,t,n,o){a.message=t,a.okCallback=void 0===n?null:n,a.cancelCallback=void 0===o?null:o,a.show()})}angular.module("MonstaFTP").controller("ModalConfirmController",["$scope","jQuery",e])}(),function(){function e(e,t,n){function o(){t(s).modal("show")}function i(){t(s).modal("hide"),a.dismissCallback&&a.dismissCallback()}function r(){}var a=this,s="#modal-error";a.message="",a.show=o,a.hide=i,a.dismissCallback=r,e.$on("modal-error:show",function(e,o,i,r){n(o,r).then(function(e){a.message=e},function(){a.message=o}),a.dismissCallback=i,t(s).modal("show")}),t(s).on("shown.bs.modal",function(){e.$apply()})}angular.module("MonstaFTP").controller("ModalErrorController",e),e.$inject=["$scope","jQuery","$translate"]}(),function(){function e(e,t,n,o,i,r){function a(){m.model={forgotPasswordUsername:"",resetPasswordUsername:"",currentPassword:"",resetPassword:"",confirmPassword:""}}function s(){a(),t(p).modal("show")}function c(){t(p).modal("hide")}function l(){c(),n.$broadcast("modal-login:show")}function u(e,t){return void 0!=e.data&&void 0!=e.data.errors&&e.data.errors.length>0&&""!=e.data.errors[0]?e.data.errors[0]:t}function d(e,t){return void 0!=e.data&&void 0!=e.data.data&&""!=e.data.data?e.data.data:t}function f(){if(m.forgotPasswordFailed=!1,m.forgotPasswordSucceeded=!1,""===m.model.forgotPasswordUsername)return m.forgotPasswordFailedMessage="FORM_INCOMPLETE_ERROR",void(m.forgotPasswordFailed=!0);o.forgotPassword(m.model.forgotPasswordUsername).then(function(e){m.forgotPasswordSucceededMessage=d(e,"FORGOT_PASSWORD_SUCCEEDED"),m.forgotPasswordSucceeded=!0},function(e){m.forgotPasswordFailedMessage=u(e,"FORGOT_PASSWORD_FAILED"),m.forgotPasswordFailed=!0})}function h(){return m.resetPasswordFailed=!1,m.resetPasswordSucceeded=!1,""===m.model.resetPasswordUsername||""===m.model.currentPassword||""===m.model.resetPassword||""===m.model.confirmPassword?(m.resetPasswordFailedMessage="FORM_INCOMPLETE_ERROR",void(m.resetPasswordFailed=!0)):m.model.resetPassword!==m.model.confirmPassword?(m.resetPasswordFailedMessage="PASSWORD_MISMATCH_ERROR",void(m.resetPasswordFailed=!0)):void o.resetPassword(m.model.resetPasswordUsername,m.model.currentPassword,m.model.resetPassword).then(function(e){m.resetPasswordSucceededMessage=d(e,"RESET_PASSWORD_SUCCEEDED"),m.resetPasswordSucceeded=!0},function(e){m.resetPasswordFailedMessage=u(e,"RESET_PASSWORD_FAILED"),m.resetPasswordFailed=!0})}var p="#modal-password-management",m=this;m.forgotPasswordAvailable=!1,m.resetPasswordAvailable=!1,m.forgotPasswordFailed=!1,m.forgotPasswordSucceeded=!1,m.resetPasswordFailed=!1,m.resetPasswordSucceeded=!1,m.forgotPasswordFailedMessage="FORGOT_PASSWORD_FAILED",m.forgotPasswordSucceededMessage="FORGOT_PASSWORD_SUCCEEDED",m.resetPasswordFailedMessage="RESET_PASSWORD_FAILED",m.resetPasswordSucceededMessage="RESET_PASSWORD_SUCCEEDED",m.show=s,m.showLoginPanel=l,m.initiateForgotPassword=f,m.initiateResetPassword=h,a(),e.$on("modal-password-management:show",function(){m.show()}),e.$on("license-loaded",function(){i.isLicensed()&&1===i.productEdition&&r.getSystemConfiguration().then(function(){m.resetPasswordAvailable=g_resetPasswordAvailable&&r.getApplicationSetting("enableResetPassword"),m.forgotPasswordAvailable=g_forgotPasswordAvailable&&r.getApplicationSetting("enableForgotPassword"),m.forgotPasswordAvailable?m.currentTab="forgot":m.currentTab="reset"},function(){})})}angular.module("MonstaFTP").controller("ModalPasswordManagementController",["$scope","jQuery","$rootScope","connectionFactory","licenseFactory","configurationFactory",e])}(),function(){function e(e,t,n,o,i,r){function a(){o(v).modal("show"),e.invalidRange=!1}function s(){e.filePaths=null,e.invalidRange=!1,o(v).modal("hide")}function c(t){e.permissions=i.numericToObject(t)}function l(e){for(;e.length<3;)e="0"+e;return e}function u(t){e.formattedPermissions=E.zeroPadLeft(t.toString(8))}function d(){null!=e.permissions&&E.setFormattedPermissions(i.objectToNumeric(e.permissions))}function f(t){var n=parseInt(t,8);return(isNaN(n)||n<0||n>511)&&(n=0,e.invalidRange=!0),n}function h(){E.setPermissions(E.validateFormattedPermission(e.formattedPermissions))}function p(n,o){e.saving=!1,r(["PERMISSIONS_FAILURE_PRECEDING_MESSAGE",n],o).then(function(e){t.$broadcast("modal-error:show",e.PERMISSIONS_FAILURE_PRECEDING_MESSAGE+" "+e[n])})}function m(){e.saving=!1,t.$broadcast("change-directory"),E.hide()}function g(e,t,n){null!=e?r([e.errorName,t],e.context).then(function(n){E.permissionSaveError(n[e.errorName],{action:n[t]})},function(){E.permissionSaveError(parseErrorResponse(n,t),{action:t})}):r(t).then(function(e){E.permissionSaveError(parseErrorResponse(n,e),{action:e})},function(){E.permissionSaveError(parseErrorResponse(n,t),{action:t})})}function y(){var t=0,o=i.objectToNumeric(e.permissions),a=function(){++t==e.filePaths.length&&E.permissionSaveSuccess()};e.saving=!0,e.filePaths.map(function(e){n.changePermissions(e,o).then(function(){a()},function(e){var t="CHANGE_PERMISSIONS_OPERATION",n=getLocalizedErrorFromResponse(e);void 0==n.context.operation&&(n.context.operation=t),r(n.context.operation).then(function(t){n.context.operation=t,g(n,t,e)},function(){g(n,t,e)})})})}var v="#modal-chmod",E=this;e.filePaths=null,e.permissions=null,e.formattedPermissions=null,e.invalidRange=!1,e.saving=!1,E.show=a,E.hide=s,E.validateFormattedPermission=f,E.formattedPermissionsChange=h,E.setPermissions=c,E.zeroPadLeft=l,E.setFormattedPermissions=u,E.permissionsChange=d,E.permissionSaveError=p,E.permissionSaveSuccess=m,E.initiatePermissionsSave=y,e.$on("modal-permissions:show",function(t,n,o){e.filePaths=n,E.setPermissions(o),E.show()}),e.$watch("permissions",E.permissionsChange,!0),e.$watch("formattedPermissions",E.formattedPermissionsChange),e.manualFocus=function(){e.invalidRange=!1},e.okClick=function(){e.invalidRange||E.initiatePermissionsSave()},e.cancelClick=function(){E.hide()},e.keyUp=function(t){if(13==t.keyCode){if(e.formattedPermissions=parseInt(t.target.value),h(),e.invalidRange)return;E.initiatePermissionsSave()}}}angular.module("MonstaFTP").controller("ModalPermissionsController",e),e.$inject=["$scope","$rootScope","connectionFactory","jQuery","permissionsFactory","$translate"]}(),function(){function e(e,t,n){var o=this;this.setVars=function(t,o,i){n(t).then(function(t){e.title=t},function(){e.title=t}),n(i).then(function(t){e.placeHolder=t},function(){e.placeHolder=i}),e.initial=o,e.final=o,e.errorSet=!1,e.errorMessage="",e.isBusy=!1,e.busyMessage=null,this.updateDismissMessage()},this.updateDismissMessage=function(){n(e.busyMessage||"DISMISS_OK_ACTION").then(function(t){e.dismissMessage=t},function(t){e.dismissMessage=t})},t("#modal-prompt").on("shown.bs.modal",function(){t(this).find("input[type=text]").focus()}),this.setVars("","",""),this.successCallback=function(){},e.successClose=function(){o.successCallback(e.final,e.initial)},e.handlePromptKeypress=function(t){13==t.which&&e.successClose()},this.show=function(){t("#modal-prompt").modal("show"),o.clearError(),o.clearBusy()},this.hide=function(){t("#modal-prompt").modal("hide")},this.clearError=function(){e.errorSet=!1,e.errorMessage=""},this.setBusy=function(t){e.isBusy=!0,e.busyMessage=t,this.updateDismissMessage()},this.clearBusy=function(){e.isBusy=!1,e.busyMessage=null,this.updateDismissMessage()},e.$on("modal-prompt:show",function(e,t,n,i,r){o.setVars(t,n,i),o.successCallback=r,o.show()}),e.$on("modal-prompt:set-error",function(t,o){e.errorSet=!0,n(o).then(function(t){e.errorMessage=t},function(){e.errorMessage=o})}),e.$on("modal-prompt:clear-error",function(){o.clearError()}),e.$on("modal-prompt:hide",function(){o.hide()}),e.$on("modal-prompt:set-busy",function(e,t){o.setBusy(t)}),e.$on("modal-prompt:clear-busy",function(){o.clearBusy()})}angular.module("MonstaFTP").controller("ModalPromptController",e),e.$inject=["$scope","jQuery","$translate"]}(),function(){function e(e,t,n,o,i,r){function a(){d=h.applicationSettings.showDotFiles,e(f).modal("show")}function s(){e(f).modal("hide")}function c(e){h.systemShowDotFiles=e.applicationSettings.showDotFiles,p=Object.keys(e.applicationSettings)}function l(e){showResponseError(e,"SYSTEM_VAR_LOAD_OPERATION",o,i)}function u(){for(var e in h.applicationSettings)h.applicationSettings.hasOwnProperty(e)&&r.setConfigurationItem(e,h.applicationSettings[e]);s()}var d,f="#modal-settings",h=this,p=[];h.applicationSettings={},h.show=a,h.saveSettings=u,h.debug=DEBUG,h.systemShowDotFiles=!1,h.languageFiles=g_languageFiles,n.getSystemConfiguration().then(c,l),t.$on("modal-settings:show",function(){r.getApplicationSettings().then(function(){for(var e=0;e<p.length;++e){var t=p[e];h.applicationSettings[t]=r.getConfigurationItem(t)}h.show()},l)}),o.$on("configuration:key-changed",function(e,t,n){"language"===t&&i.use(n)})}angular.module("MonstaFTP").controller("ModalSettingsController",e),e.$inject=["jQuery","$scope","configurationFactory","$rootScope","$translate","localConfigurationFactory"]}(),function(){function e(e,t){function n(){e(r).modal("hide")}function o(t){i.item=t,e(r).modal("show")}var i=this,r="#modal-properties";i.item=null,i.hide=n,i.show=o,t.$on("modal-properties:show",function(e,t){i.show(t)})}angular.module("MonstaFTP").controller("ModalPropertiesController",e),e.$inject=["jQuery","$scope"]}(),function(){function e(e,n,o,i,r,a,s){function c(n){var i=angular.copy(e.getUploads());if(0===i.length){if(A)return;v=null,r(y.hide,TRANSFER_COMPLETE_MODAL_HIDE_DELAY),A=!0}else{var a=n?0:t;n&&null!=v&&(clearTimeout(v),v=null),null==v&&(y.uploads=i,v=r(function(){o.$apply(),v=null},a))}}function l(e,t){t?(y.currentUploadNumber=Math.min(y.currentUploadNumber+1,y.completedUploadTotal),S=!0):--y.completedUploadTotal<0&&(y.completedUploadTotal=0),y.updateUploads()}function u(){E||(i(g).modal("show"),E=!0,A=!1)}function d(){S&&n.$broadcast("change-directory"),i(g).modal("hide"),E=!1}function f(t){e.abortItem(t),y.updateUploads()}function h(){e.abortAll()}function p(e){var t=s.currentDirectory;"/"!=t.substr(t.length-1)&&(t+="/");var n=0;return"/"==e.substr(0,1)&&(e=e.substr(1),n=1),e.substr(t.length-n)}function m(){y.completedUploadTotal=e.getUploads().length,y.updateUploads(),u()}var g="#modal-transfers",y=this,v=null,E=!1,S=!1,A=!1;y.updateUploads=c,y.uploadFinished=l,y.show=u,y.hide=d,y.abortItem=f,y.abortAll=h,y.remotePathToRelative=p,y.uploadAdded=m,y.fsFilter=a("file_size"),y.uploads=[],y.itemToAbort=null,y.currentUploadNumber=1,y.completedUploadTotal=0,e.updateCallback=y.updateUploads,o.$on("upload:load",y.uploadFinished),o.$on("upload:add",y.uploadAdded),o.$on("upload:update",function(e,t){S=S||t,y.updateUploads()}),y.remainingFilesMessage="",i(g).on("hidden.bs.modal",function(){y.uploads=[],y.currentUploadNumber=1,S=!1})}var t=200;angular.module("MonstaFTP").controller("ModalTransferController",e),e.$inject=["uploadFactory","$rootScope","$scope","jQuery","$timeout","$filter","uiOperationFactory"]}(),function(){function e(e){function t(t){var n="";t.stats.completedItems==t.stats.totalItems&&(n=" progress-bar-striped"),t.hasError||(n+=" active");var o=e(t);return'<div class="progress-bar progress-bar-success'+n+'" role="progressbar" aria-valuenow="'+o+'" aria-valuemin="0" aria-valuemax="100" style="width: '+o+'%;"></div>'}return{restrict:"E",scope:{transfer:"="},template:"<div></div>",link:function(e,n,o){var i=function(){n.html(t(e.transfer))};i(),e.$watch("transfer.stats",function(){i()},!0),e.$watch("transfer.archiveExtractCurrent",function(){i()},!0)}}}angular.module("MonstaFTP").directive("uploadProgressBar",e),e.$inject=["transfer_percentFilter"]}(),angular.module("MonstaFTP").controller("ModalUpgradeRequiredController",ModalUpgradeRequiredController),ModalUpgradeRequiredController.$inject=["$rootScope","jQuery","$translate"],String.prototype.hashCode=function(){var e,t,n=0;if(0===this.length)return n;for(e=0;e<this.length;e++)t=this.charCodeAt(e),n=(n<<5)-n+t,n|=0;return n},function(){function e(){return{objectToNumeric:function(e){return(e.ownerRead?256:0)+(e.ownerWrite?128:0)+(e.ownerExecute?64:0)+(e.groupRead?32:0)+(e.groupWrite?16:0)+(e.groupExecute?8:0)+(e.otherRead?4:0)+(e.otherWrite?2:0)+(e.otherExecute?1:0)},numericToObject:function(e){return{ownerRead:0!=(256&e),ownerWrite:0!=(128&e),ownerExecute:0!=(64&e),groupRead:0!=(32&e),groupWrite:0!=(16&e),groupExecute:0!=(8&e),otherRead:0!=(4&e),otherWrite:0!=(2&e),otherExecute:0!=(1&e)}}}}angular.module("MonstaFTP").factory("permissionsFactory",e)}(),function(){function e(e,t,n,o,i,r,a){function s(){null!=y&&y.close("slidebar")}function c(){s(),t.logout(),n.$broadcast("logout")}function l(e){s(),n.$broadcast("modal-confirm:show",e,g.confirmLogout)}function u(){s(),i("LOGOUT_CONFIRM_MESSAGE").then(l,l)}function d(){s(),n.$broadcast("modal-addons:show")}function f(){s(),n.$broadcast("modal-settings:show")}function h(){s(),n.$broadcast("modal-login:show")}function p(e){return!!g.itemDisplay.hasOwnProperty(e)&&!1===g.itemDisplay[e]}function m(){var e=allInterfaceOptionsDisabled(v,g.itemDisplay),t=document.getElementsByTagName("body")[0];e?t.classList.add("no-slidebar"):t.classList.remove("no-slidebar")}var g=this,y=null,v=["logout","change-server","settings","addons","help"];g.showHelpButton=!0,g.showAddOnsButton=!0,g.showChangeServerButton=!0,g.customHelpUrl=null,g.itemDisplay={},o("#slidebar").ready(function(){y=new slidebars,y.init()}),o("#slidebar-toggle").click(function(){null!=y&&y.toggle("slidebar")}),g.confirmLogout=c,g.initiateLogout=u,g.showAddonsModal=d,g.showSettingsModal=f,g.showLoginPanel=h,g.itemHidden=p,e.$on("license-loaded",function(){a.isLicensed()&&r.getSystemConfiguration().then(function(){g.showHelpButton=!r.getApplicationSetting("disableHelpButton"),g.showAddOnsButton=!r.getApplicationSetting("disableAddOnsButton"),g.customHelpUrl=r.getApplicationSetting("helpUrl"),g.showChangeServerButton=!r.getApplicationSetting("disableChangeServerButton"),g.itemDisplay=r.getApplicationSetting("sidebarItemDisplay")||{},m()},function(){})}),e.$on("file-editor:will-show",function(){s()})}angular.module("MonstaFTP").controller("SlidebarController",e),e.$inject=["$scope","authenticationFactory","$rootScope","jQuery","$translate","configurationFactory","licenseFactory"]}(),function(){function e(e){return{cutSource:null,copySource:null,currentDirectory:"",currentDirectoryList:[],setCutSource:function(t){this.cutSource=t,this.copySource=null,null!=t&&e.$broadcast("paste-source:set")},setCopySource:function(t){this.copySource=t,this.cutSource=null,null!=t&&e.$broadcast("paste-source:set")},pasteComplete:function(){null!=this.cutSource&&e.$broadcast("paste-source:cleared"),this.cutSource=null},clearCutAndCopySource:function(){this.copySource=null,this.cutSource=null,e.$broadcast("paste-source:cleared")},isCutOrCopySource:function(e){return e==this.copySource||e==this.cutSource},joinNameToCurrentDirectory:function(e){return pathJoin(this.currentDirectory,e)},itemIsInCurrentDirectoryList:function(e){for(var t=0;t<this.currentDirectoryList.length;++t)if(this.currentDirectoryList[t].name===e)return!0;return!1},itemInCurrentDirectoryIsDirectory:function(e){for(var t=0;t<this.currentDirectoryList.length;++t)if(this.currentDirectoryList[t].name===e)return!!this.currentDirectoryList[t].isDirectory;return!1}}}angular.module("MonstaFTP").factory("uiOperationFactory",e),e.$inject=["$rootScope"]}(),function(){function e(e){e.spinnerVisible=!1,e.$on("request-count-change",function(t,n){e.spinnerVisible=0!=n})}angular.module("MonstaFTP").controller("SpinnerController",e),e.$inject=["$scope"]}(),function(){function e(e){function t(e,t){void 0!==t.name&&delete t.name;var n={t:e,c:f.compactConfigKeys(t)};return encodeURIComponent(b64EncodeUnicode(JSON.stringify(n)))}function n(e){var t=JSON.parse(b64DecodeUnicode(decodeURIComponent(e)));return{type:t.t,configuration:f.uncompactConfigKeys(t.c)}}function o(e){if(isEmpty(e))return null;"/"==e.substr(0,1)&&(e=e.substr(1));var t=e.split("/");if(t.length<4||"c"!=t[0])return null;var n=t[1],o=t[2],i=null,r=t.slice(3,t.length).join("/");try{i=f.decodeConfiguration(r)}catch(e){return null}if("_"!=n&&(i.configuration.host=n),"_"!=o){var a="sftp"==i.type?"remoteUsername":"username";i.configuration[a]=o}return i}function i(){return e.absUrl().split("#")[0]}function r(e,t){if(null==t)return null;t=angular.copy(t);var n=null,o=null;t.hasOwnProperty("host")&&(n=t.host,delete t.host);var i="sftp"==e?"remoteUsername":"username";t.hasOwnProperty(i)&&(o=t[i],delete t[i]),n=isEmpty(n)?"_":encodeURIComponent(n),o=isEmpty(o)?"_":encodeURIComponent(o);var r="/c/"+n+"/"+o+"/"+f.encodeConfiguration(e,t);return f.getPreHashURL()+"#"+r}function a(){var t=e.absUrl(),n=t.split("#");return 1==n.length?null:o(n[1])}function s(e){for(var t=[["passive","v"],["ssl","s"],["password","p"],["initialDirectory","i"],["port","o"],["authenticationModeName","m"],["privateKeyFilePath","r"],["publicKeyFilePath","q"]],n=e?1:0,o=e?0:1,i={},r=0;r<t.length;++r)i[t[r][o]]=t[r][n];return i}function c(e,t){var n={},o=s(e);for(var i in t)if(t.hasOwnProperty(i)){var r=t[i];o.hasOwnProperty(i)&&(i=o[i]),e?!0===r?r=1:!1===r&&(r=0):(1===r&&(r=!0),0===r&&(r=!1)),n[i]=r}return n}function l(e){return c(!0,e)}function u(e){return c(!1,e)}function d(e,t){var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};return t=String(t).replace(/[&<>"]/g,function(e){return n[e]}),'<input type="hidden" name="'+e+'" value="'+t+'">'}var f={};return f.encodeConfiguration=t,f.decodeConfiguration=n,f.getPreHashURL=i,f.getConfigURL=r,f.compactConfigKeys=l,f.uncompactConfigKeys=u,f.decodePostHash=o,f.getConfigFromCurrentURL=a,f.getFormFieldHTML=d,f}angular.module("MonstaFTP").factory("requestLoginFactory",e),e.$inject=["$location"]}(),function(){function e(e,t,n,o,i,r){function a(){v.automaticUpgradeUnavailableReasons=[],o.isLicensed()?(v.isLicensed=!0,v.automaticUpgradeAvailable=!0,n.checkSavedAuthExists().then(function(e){v.hasServerSavedAuthentication=!0===e.data.data,v.hasServerSavedAuthentication||(v.automaticUpgradeAvailable=!1,v.automaticUpgradeUnavailableReason="AUTOMATIC_UPGRADE_REQUIRES_PROFILE_PASSWORD_MESSAGE"),t(E).modal("show")},function(){v.hasServerSavedAuthentication=!1,v.automaticUpgradeAvailable=!1,v.automaticUpgradeUnavailableReasons.push("AUTOMATIC_UPGRADE_REQUIRES_PROFILE_PASSWORD_MESSAGE"),t(E).modal("show")})):(v.isLicensed=!1,v.automaticUpgradeAvailable=!1,t(E).modal("show")),r.getSystemConfiguration().then(function(e){e.curlAvailable||(v.automaticUpgradeUnavailableReasons.push("CURL_NOT_INSTALLED_MESSAGE"),v.automaticUpgradeAvailable=!1)},function(e){})}function s(){t(E).modal("hide")}function c(e){13===e.which&&u()}function l(e,t){var n,o=getLocalizedErrorFromResponse(e),r={};null==o?n=parseErrorResponse(e,t):(n=o.errorName,void 0!==o.context&&(r=o.context)),i(n,r).then(function(e){v.storedAuthenticationErrorMessage=e},function(){v.storedAuthenticationErrorMessage=n})}function u(){""!==v.model.masterPassword&&n.validateSavedAuthPassword(v.model.masterPassword).then(function(e){!0===e.data.data?(v.storedAuthenticationErrorMessage="",v.startUpgradeEnabled=!0):(v.storedAuthenticationErrorMessage="PROBABLE_INCORRECT_PASSWORD_ERROR",v.startUpgradeEnabled=!1)},function(e){l(e,"validating password")})}function d(){n.downloadLatestVersionArchive(v.model.masterPassword).then(function(e){v.downloadInProgress=!1,!0===e.data.data?h():l(e,"downloading upgrade")},function(e){v.downloadInProgress=!1,l(e,"downloading upgrade")})}function f(){if(!v.startUpgradeEnabled)return!1;v.downloadInProgress=!0,v.modalTitle="UPGRADING_TITLE",d()}function h(){v.installInProgress=!0,n.installLatestVersion(v.model.masterPassword).then(function(e){v.installInProgress=!1,!0===e.data.data?(v.upgradeComplete=!0,i("UPGRADE_COMPLETE_MESSAGE",{version:v.latestVersion}).then(function(e){v.upgradeCompleteMessage=e},function(e){v.upgradeCompleteMessage="UPGRADE_COMPLETE_MESSAGE"})):l(e,"installing upgrade")},function(e){v.installInProgress=!1,l(e,"installing upgrade")})}function p(){return"STRONG_TAG_START"+v.latestVersion+"STRONG_TAG_END"}function m(e){v.latestVersionMessage=e.LATEST_VERSION_AVAILABLE_MESSAGE.replace(/STRONG_TAG_START/g,"<strong>").replace(/STRONG_TAG_END/g,"</strong>");var t="A_TAG_START"+e.RELEASE_NOTES_UPGRADE_LINK_TEXT+"A_TAG_END",n="A_TAG_START"+e.UPGRADE_DOWNLOAD_LINK_TEXT+"A_TAG_END";i(["PRE_UPGRADE_RELEASE_NOTES_MESSAGE","AUTOMATIC_UPGRADE_LICENSED_ONLY_MESSAGE"],{release_notes_link:t,download_link:n}).then(g,function(e){})}function g(e){var t=e.PRE_UPGRADE_RELEASE_NOTES_MESSAGE,n=e.AUTOMATIC_UPGRADE_LICENSED_ONLY_MESSAGE;t=t.replace(/A_TAG_START/g,'<a href="'+RELEASE_NOTES_URL+'" target="mftp-new" rel="noopener noreferrer">'),v.releaseNotesMessage=t.replace(/A_TAG_END/g,"</a>"),n=n.replace(/A_TAG_START/g,'<a href="'+MFTP_DOWNLOAD_URL+'" target="mftp-new" rel="noopener noreferrer">'),v.licensedOnlyMessage=n.replace(/A_TAG_END/g,"</a>")}function y(){window.location=window.location}var v=this,E="#modal-update";v.latestVersion=window.MONSTA_LATEST_VERSION,v.latestVersionFormatted=p(),v.licensedOnlyMessage="",v.releaseNotesMessage="",v.hasServerSavedAuthentication=!1,v.isLicensed=!1,v.startUpgradeEnabled=!1,v.storedAuthenticationErrorMessage="",v.modalTitle="UPDATE_AVAILABLE",v.downloadInProgress=!1,v.installInProgress=!1,v.automaticUpgradeAvailable=!1,v.automaticUpgradeUnavailableReason="",v.upgradeComplete=!1,v.upgradeCompleteMessage="",v.refresh=y,v.model={masterPassword:""},v.show=a,v.hide=s,v.handlePasswordKeypress=c,v.validatePassword=u,v.startUpgrade=f,e.$on("modal-update:show",function(){v.latestVersion=window.MONSTA_LATEST_VERSION,v.latestVersionFormatted=p(),i(["LATEST_VERSION_AVAILABLE_MESSAGE","RELEASE_NOTES_UPGRADE_LINK_TEXT","UPGRADE_DOWNLOAD_LINK_TEXT"],{version:v.latestVersionFormatted}).then(m,function(e){}),a()})}angular.module("MonstaFTP").controller("UpdateController",e),e.$inject=["$scope","jQuery","connectionFactory","licenseFactory","$translate","configurationFactory","$sce"]}(),function(){function e(e,t,n){return{updateCallback:null,_uploads:[],_activeUploadCount:0,addUpload:function(e,n,o,i,r){return!(-1!=MAX_UPLOAD_BYTES&&i>MAX_UPLOAD_BYTES)&&(this._uploads.push({name:e,remotePath:n,file:o,request:null,stats:new TransferStats(i),hasError:!1,isArchive:r,archiveExtractMax:0,archiveExtractCurrent:-1,sessionKey:null,isAngularRequest:!1,errorText:null}),t.$broadcast("upload:add"),this._activeUploadCount<MAX_CONCURRENT_UPLOADS&&this.startUploadOfItemAtIndex(this._uploads.length-1),!0)},addExtract:function(e,n,o){var i=new TransferStats(1);i.transferType="extract",i.complete();var r={name:e,localRelativePath:null,remotePath:null,file:null,request:null,stats:i,hasError:!1,isArchive:!0,archiveExtractMax:o,archiveExtractCurrent:0,sessionKey:null,forceComplete:!0,isAngularRequest:!1};this._uploads.push(r),this.progressExtract(n,r,o,0),t.$broadcast("upload:add")},startNextItem:function(){if(!(this._activeUploadCount>=MAX_CONCURRENT_UPLOADS))for(var e=0;e<this._uploads.length;++e)if(!this._uploads[e].stats.hasBeenStarted()){this.startUploadOfItemAtIndex(e);break}},getUploads:function(){return this._uploads},getUploadItem:function(e){return this._uploads[e]},progressItem:function(e,t){e.stats.updateTransferAmount(t)&&null!=this.updateCallback&&this.updateCallback()},getUploadRequestBody:function(t,n){var o=e.getRequestBody();return o.actionName=n?UPLOAD_ARCHIVE_ACTION:UPLOAD_ACTION,o.context={remotePath:t},o},encodeRequestBody:function(e){return b64EncodeUnicode(JSON.stringify(e))},getXHR:function(){return new XMLHttpRequest},startXHR:function(e,t,n){++this._activeUploadCount,e.open("POST",UPLOAD_PATH),e.setRequestHeader("X-Monsta",this.encodeRequestBody(t)),e.setRequestHeader("Content-Type","application/octet-stream"),e.send(n),null!=this.updateCallback&&this.updateCallback(!0)},startMultiStageUploadXHR:function(e,t,n){e.open("POST",MULTI_STAGE_UPLOAD_PATH+"?sessionKey="+t),e.setRequestHeader("Content-Type","application/octet-stream"),e.send(n),null!=this.updateCallback&&this.updateCallback(!0)},addEventProgressListenersToRequest:function(e,t,o){var i=this;e.upload.addEventListener("progress",function(n){e.readyState==XMLHttpRequest.OPENED&&i.progressItem(t,n.lengthComputable?n.loaded:null)},!1),e.upload.addEventListener("load",function(){t.stats.completedItems=t.stats.totalItems,null!=i.updateCallback&&i.updateCallback()},!1),e.onreadystatechange=function(){if(e.readyState===XMLHttpRequest.DONE)if(200===e.status)FEATURE_MULTI_STAGE_UPLOAD?i.transferItemAtIndexToRemote(o):i.completeItem(t,e.responseText,!1,!0);else if(0!==e.status){safeConsoleError(e);var r=null,a=!1;try{var s=JSON.parse(e.responseText),c=getLocalizedErrorFromResponseData(s);r=getErrorMessageFromResponseData(s),null!==c&&(a=!0,n([c.errorName,c.context.operation],c.context).then(function(n){var o=n[c.errorName];o=o.replace(c.context.operation,n[c.context.operation]),i.setItemError(t,e.status,e.statusText,o)},function(){i.setItemError(t,e.status,e.statusText,r)}))}catch(e){}a||i.setItemError(t,e.status,e.statusText,r)}}},startStandardUploadOfItemAtIndex:function(e){var t=this._uploads[e],n=this.getXHR();t.request=n;var o=this.getUploadRequestBody(t.remotePath,t.isArchive);this.addEventProgressListenersToRequest(n,t,e),this.startXHR(n,o,t.file),t.stats.wasStarted()},startMultiStageUploadOfItemAtIndex:function(e,t){var n=this._uploads[e],o=this.getXHR();n.request=o,n.sessionKey=t,this.addEventProgressListenersToRequest(o,n,e),this.startMultiStageUploadXHR(o,t,n.file),n.stats.wasStarted()},startUploadOfItemAtIndex:function(o){if(FEATURE_MULTI_STAGE_UPLOAD){++this._activeUploadCount;var i=this,r=this._uploads[o];e.reserveUploadContext(UPLOAD_ACTION,r.remotePath).then(function(e){if(responseIsUnsuccessful(e))return void showResponseError(e,"UPLOAD_OPERATION",t,n);i.startMultiStageUploadOfItemAtIndex(o,e.data.data)},function(e){showResponseError(e,"UPLOAD_OPERATION",t,n)})}else this.startStandardUploadOfItemAtIndex(o)},handleExtractProgressErrorResponse:function(o,i,r){i.request=null,i.shouldAbort?e.cleanUpExtract(r):showResponseError(o,"EXTRACT_ARCHIVE_OPERATION",t,n),t.$broadcast("upload:update",!0),this.completeItem(i,null,!0,!1)},handleExtractProgressSuccessResponse:function(n,o,i,r,a){if(void 0!==n.data.errors)return void this.handleExtractProgressErrorResponse(n,o,i);o.request=null;var s=n.data.data[0],c=n.data.data[1];o.archiveExtractCurrent=Math.min(a+c,r),o.stats.updateTransferAmount(o.archiveExtractCurrent),t.$broadcast("upload:update",!0),s?this.completeItem(o,null,!0,!0):!0===o.shouldAbort?e.cleanUpExtract(i):this.progressExtract(i,o,r,a+c)},progressExtract:function(n,o,i,r){var a=this,s=e.extractArchive(n,r,1e4);o.request=s,o.isAngularRequest=!0,t.$broadcast("upload:update"),s.promise.then(function(e){a.handleExtractProgressSuccessResponse(e,o,n,i,r)},function(e){a.handleExtractProgressErrorResponse(e,o,n)})},transferItemAtIndexToRemote:function(o){var i=this._uploads[o],r=this;e.transferUploadToRemote(i.sessionKey).then(function(e){if(responseIsUnsuccessful(e))return void showResponseError(e,"UPLOAD_OPERATION",t,n);r.completeItem(i,null,!1,!0)},function(e){showResponseError(e,"UPLOAD_OPERATION",t,n),r.completeItem(i,null,!1,!1)})},completeItem:function(e,n,o,i){var r=this;if(e.isArchive&&!o){var a=JSON.parse(n);e.archiveExtractCurrent=0,e.archiveExtractMax=a.fileCount,e.stats=new TransferStats(a.fileCount),e.stats.transferType="extract",this.progressExtract(a.fileKey,e,a.fileCount,0)}else--this._activeUploadCount,e.request=null,e.stats.complete(),this.removeItem(e),setTimeout(function(){r.broadcastComplete.call(r,i)},0);t.$broadcast("upload:update")},broadcastComplete:function(e){t.$broadcast("upload:load",e),this.startNextItem(),null!=this.updateCallback&&this.updateCallback(!0)},abortItemUploadRequest:function(e){e.isArchive||null==e.request||(e.request.abort(),e.request=null),e.isArchive&&(e.shouldAbort=!0,null!=e.request&&(e.isAngularRequest?e.request.cancel("aborted"):e.request.abort(),e.request=null))},abortItem:function(e){e=this.getOriginalUploadItem(e),--this._activeUploadCount,this.abortItemUploadRequest(e),this.removeItem(e),t.$broadcast("upload:abort"),this.startNextItem()},removeItem:function(e){this._uploadIterator(function(t,n){if(e.remotePath==n.remotePath)return null==n.request&&(this._uploads.splice(t,1),!1)})},setItemError:function(e,t,n,o){e.hasError=!0,e.statusCode=t,e.statusText=n,e.errorText=o,null!=e.request&&(e.request=null,null!=this.updateCallback&&this.updateCallback(!0))},_uploadIterator:function(e){for(var t=0;t<this._uploads.length&&!1!==e.call(this,t,this._uploads[t]);++t);},abortAll:function(){for(var e=0;e<this._uploads.length;++e){var t=this._uploads[e];this.abortItemUploadRequest(t)}this._uploads=[],this._activeUploadCount=0,null!=this.updateCallback&&this.updateCallback(!0)},getOriginalUploadItem:function(e){var t=null;return this._uploadIterator(function(n,o){if(e.remotePath==o.remotePath)return t=o,!1}),t}}}angular.module("MonstaFTP").factory("uploadFactory",e),e.$inject=["connectionFactory","$rootScope","$translate"]}(),function(){function e(e,t,n,o,i,r,a){function s(e){i.$broadcast("modal-error:show",e,function(){})}function c(e,t){for(var n=0;n<t.length;++n){var o=t[n];e+="<br>&nbsp;&nbsp;&nbsp;&nbsp;"+o[0]+" ("+d(o[1])+")"}s(e)}function l(e,t,n){t.$broadcast("modal-choice:show","EXTRACT_AFTER_UPLOAD_TITLE",n,function(){e.filesToQueue.splice(e.fileQueueIndex,1),e.processUploadQueue()},[["UPLOAD_STANDARD_ACTION",function(){e.uploadStandardCallback()}],["UPLOAD_EXTRACT_ACTION",function(){e.uploadAndExtractCallback()}]])}function u(e,t,n,o,i){t.$broadcast("modal-choice:show",n,o,function(){e.cancelAll()},[["UPLOAD_OVERWRITE_ACTION",function(){e.confirmOverwriteCallback(i)}],["UPLOAD_KEEP_ACTION",function(){e.filesToQueue.splice(e.fileQueueIndex,1),e.processUploadQueue()}]])}var d=o("file_size");return{tooLargeFiles:[],filesToQueue:[],fileQueueIndex:0,treeTotalSize:0,treeProcessed:0,traverseFinished:!1,directoryReader:null,directoryEntries:[],uploadStandardCallback:function(){this.filesToQueue[this.fileQueueIndex][4]=!1,this.processUploadQueue()},uploadAndExtractCallback:function(){this.filesToQueue[this.fileQueueIndex][4]=!0,this.processUploadQueue()},promptForExtract:function(e){var t=this;r("EXTRACT_AFTER_UPLOAD_MESSAGE",{file_name:"TAG_STRONG_START"+e+"TAG_STRONG_END",file_type:"TAG_STRONG_START"+extractFileExtension(e)+"TAG_STRONG_END"}).then(function(e){l(t,i,e)},function(){l(t,i,"Extract "+e+" after uploading?")})},displayConfirmOverwrite:function(e){var t=this;r(["CONFIRM_UPLOAD_OVERWRITE_MESSAGE","CONFIRM_UPLOAD_OVERWRITE_TITLE"],{file_name:"TAG_STRONG_START"+e+"TAG_STRONG_END"}).then(function(n){u(t,i,n.CONFIRM_UPLOAD_OVERWRITE_TITLE,n.CONFIRM_UPLOAD_OVERWRITE_MESSAGE,e)},function(){u(t,i,"Replace "+e+"?",e+" exists, replace it with the one you are uploading?",e)})},confirmOverwriteCallback:function(n){var o=this;e.itemInCurrentDirectoryIsDirectory(n)?t.deleteDirectory(e.joinNameToCurrentDirectory(n)).then(function(){++o.fileQueueIndex,o.processUploadQueue()}):(++this.fileQueueIndex,this.processUploadQueue())},processUploadQueue:function(){if(this.fileQueueIndex>=this.filesToQueue.length)return this.checkTooLargeFiles(),void this.performUploads();var t=this.filesToQueue[this.fileQueueIndex];null==t[4]&&isExtractSupported(t[0])?this.promptForExtract(t[0]):!a.getApplicationSetting("disableUploadOverwriteConfirmation")&&t[5]&&e.itemIsInCurrentDirectoryList(t[0])?this.displayConfirmOverwrite(t[0]):(++this.fileQueueIndex,this.processUploadQueue())},cancelAll:function(){this.filesToQueue=[],this.fileQueueIndex=0,this.tooLargeFiles=[]},performUploads:function(){for(var e=0;e<this.filesToQueue.length;++e){var t=this.filesToQueue[e];n.addUpload(t[0],t[1],t[2],t[3],t[4])}this.filesToQueue=[],this.fileQueueIndex=0,this.tooLargeFiles=[]},checkTooLargeFiles:function(){if(0!=this.tooLargeFiles.length){var e=this.tooLargeFiles.slice();r("UPLOAD_FILES_TOO_LARGE_MESSAGE",{item_count:this.tooLargeFiles.length,maximum_size:d(MAX_UPLOAD_BYTES)}).then(function(t){c(t,e)},function(t){c(t,e)})}},doUploadAdd:function(t,n,o,i){if(!a.getApplicationSetting("skipMacOsSpecialFiles")||".DS_Store"!==t.name){var r=e.joinNameToCurrentDirectory(n);t.size>MAX_UPLOAD_BYTES?this.tooLargeFiles.push([n,t.size]):this.filesToQueue.push([t.name,r,t,t.size,o,i])}},readItemsInDirectory:function(e,t,n){var o=this;this.directoryReader.readEntries(function(i){if(i.length)return o.directoryEntries=o.directoryEntries.concat(i),o.readItemsInDirectory(e,t);for(var r=0;r<o.directoryEntries.length;++r)o.traverseFileTree.call(o,o.directoryEntries[r],pathJoin(e,t.name),n)})},traverseFileTree:function(e,t,n){t=t||"";var o=this;e.isFile?(++o.treeTotalSize,e.file(function(i){++o.treeProcessed;var r=pathJoin(t,e.name);o.doUploadAdd.call(o,i,r,n,""===t),o.traverseFinished&&o.treeProcessed===o.treeTotalSize&&o.processUploadQueue()})):e.isDirectory&&(this.directoryEntries=[],this.directoryReader=e.createReader(),this.readItemsInDirectory(t,e,n))},handleItemsBasedUpload:function(e,t){this.tooLargeFiles=[],this.filesToQueue=[],this.fileQueueIndex=0,this.treeTotalSize=0,this.treeProcessed=0,this.traverseFinished=!1;for(var n=0;n<e.length;++n){var o=e[n].webkitGetAsEntry();o&&this.traverseFileTree(o,null,t)}this.fileQueueIndex=0,this.traverseFinished=!0},handleFilesBasedUpload:function(e,t){this.tooLargeFiles=[],this.filesToQueue=[],this.fileQueueIndex=0;var n=0,o=this,i=function(){if(n==e.length){for(d=0;d<e.length;++d){f=e[d];var i=f.webkitRelativePath?f.webkitRelativePath:f.name;o.doUploadAdd.call(o,f,i,t,-1===i.indexOf("/"))}o.processUploadQueue()}};if(void 0==window.FileReader)return n=e.length,void i();var a=function(){++n,i()},c=function(){r("FOLDER_UPLOAD_NOT_SUPPORTED_MESSAGE").then(s,s)};if(0==e.length)return void c();for(var l=window.navigator.userAgent,u=/trident/i.test(l)||/msie/i.test(l),d=0;d<e.length;++d)if(u)a();else{var f=e[d],h=new FileReader;if(h.onerror=function(e){c()},h.onload=a,f.size<=MAX_UPLOAD_BYTES)try{var p=f.slice(0,Math.min(f.size,1024));0==p.size?h.readAsBinaryString(f):h.readAsBinaryString(p)}catch(e){}else a()}}}}angular.module("MonstaFTP").factory("uploadUIFactory",e),e.$inject=["uiOperationFactory","connectionFactory","uploadFactory","$filter","$rootScope","$translate","configurationFactory"]}(),function(){function e(e){function t(t){if("number"!=typeof t)return"";var n,o=new Date(1e3*t),i=new Date;return n=o.getDate()==i.getDate()&&o.getMonth()==i.getMonth()&&o.getFullYear()==i.getFullYear()?"shortTime":"mediumDate",e(o,n)}return t}angular.module("MonstaFTP").filter("file_last_modified",e),e.$inject=["dateFilter"]}(),angular.module("MonstaFTP").filter("file_size",function(){return function(e){return e<0&&(e=0),normalizeFileSize(e)}}),angular.module("MonstaFTP").filter("html_safe",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]),function(){function e(){function e(e,t){var n=new Date(1e3*e);return!0===t?n.getDate()+"/"+(n.getMonth()+1)+"/"+n.getFullYear():n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear()}return function(t,n){if("number"!=typeof t)return"";var o,i,r=Date.now()/1e3-t,a=[[3540,60,"minute"],[82800,3600,"hour"],[2592e3,86400,"day"]];if(r<0||r>a[a.length-1][0])return e(t,n);if(r<=60)return"now";for(var s=0;s<a.length;++s)if(!(r>a[s][0])){o=Math.round(r/a[s][1]),i=a[s][2];break}return 1!=o&&(i+="s"),o+" "+i+" ago"}}angular.module("MonstaFTP").filter("human_time_since",e)}(),angular.module("MonstaFTP").filter("icon",function(){return function(e){if(e.isDirectory)return"fa-folder";if(e.isLink)return"fa-long-arrow-right";var t="";switch(extractFileExtension(e.name)){case"doc":case"docx":t="word";break;case"xlr":case"xls":case"xlsx":t="excel";break;case"ppt":case"pps":case"pptx":t="powerpoint";break;case"pdf":t="pdf";break;case"txt":case"rtf":case"text":t="text";break;case"bmp":case"gif":case"jpg":case"png":case"psd":case"tif":case"ai":case"eps":case"svg":case"ps":case"jpeg":t="image";break;case"avi":case"flv":case"m4v":case"mov":case"mp4":case"mkv":case"mpg":case"wmv":t="video";break;case"wav":case"mp3":case"wma":case"m4a":case"m4p":case"mpa":case"flac":case"aif":case"aiff":t="audio";break;case"tar":case"zip":case"tgz":case"gz":case"gzip":case"rar":t="archive";break;case"htm":case"html":case"php":case"asp":case"aspx":case"js":case"css":case"xhtml":case"cfm":case"pl":case"py":case"c":case"cpp":case"rb":case"java":case"xml":case"json":t="code"}return"fa-file"+(""==t?"":"-")+t+"-o"}}),angular.module("MonstaFTP").filter("item_permission_description",["permissionsFactory",function(e){return function(t){var n=t.isDirectory?"d":"-",o=e.numericToObject(t.numericPermissions);return n+=o.ownerRead?"r":"-",n+=o.ownerWrite?"w":"-",n+=o.ownerExecute?"x":"-",n+=o.groupRead?"r":"-",n+=o.groupWrite?"w":"-",n+=o.groupExecute?"x":"-",n+=o.otherRead?"r":"-",n+=o.otherWrite?"w":"-",n+=o.otherExecute?"x":"-"}}]),angular.module("MonstaFTP").filter("sort_description",function(){return function(e){switch(e){case"modified":return"CHANGED";default:return e.toUpperCase()}}}),angular.module("MonstaFTP").filter("spaces_to_nbsp",function(){return function(e){return e.replace(/ /g,String.fromCharCode(160))}}),angular.module("MonstaFTP").filter("transfer_percent",function(){return function(e){if(e.forceComplete)return 100;var t=null==e.request&&"extract"!=e.stats.transferType;return e.hasError||!t||e.stats.hasBeenStarted()?null==e.stats?0:0!=e.archiveExtractMax&&-1!=e.archiveExtractCurrent?e.archiveExtractCurrent/e.archiveExtractMax*100:e.stats.getTransferPercent():0}}),angular.module("MonstaFTP").filter("transfer_rate",function(){return function(e){if(null==e.stats)return"-";var t=e.stats.calculateTransferRate(),n=normalizeFileSize(t);return""==n?"-":n+"/s"}}),String.prototype.capitalizeFirstLetter=function(){return this.charAt(0).toUpperCase()+this.slice(1)},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),document.addEventListener("lload",mCheckFn);